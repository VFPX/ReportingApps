*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="frxhandlers.vcx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS bandhandler AS frxhandlerform OF "frxbuilder.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="frame" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageGeneral.Panelband1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageProtection.Panelbandprotection1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageComment.Panelcommentuser1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageComment.Panelmemberdata1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageBand.Paneldetail1" UniqueID="" Timestamp="" />

	#INCLUDE "frxbuilder.h"
	BorderStyle = 3
	Caption = "Band"
	DoCreate = .T.
	Height = 441
	Name = "bandhandler"
	Width = 474
	grabber.Height = 11
	grabber.Left = 140
	grabber.Name = "grabber"
	grabber.Top = 376
	grabber.Width = 11
	frxcursor.Name = "frxcursor"
	cmdOK.Left = 192
	cmdOK.Name = "cmdOK"
	cmdOK.TabIndex = 2
	cmdOK.Top = 384
	cmdCancel.Left = 376
	cmdCancel.Name = "cmdCancel"
	cmdCancel.TabIndex = 3
	cmdCancel.Top = 408
	cmdHelp.Left = 296
	cmdHelp.Name = "cmdHelp"
	cmdHelp.Top = 384

	ADD OBJECT 'frame' AS pgfhandlerframe WITH ;
		ErasePage = .T., ;
		Height = 332, ;
		Left = 12, ;
		Name = "frame", ;
		PageCount = 4, ;
		TabIndex = 1, ;
		Top = 8, ;
		Width = 392, ;
		Pge1.Caption = "General", ;
		Pge1.Name = "pageGeneral", ;
		Pge1.PageOrder = 1, ;
		Pge2.Caption = "Protection", ;
		Pge2.Name = "pageProtection", ;
		Pge2.PageOrder = 3, ;
		Pge3.Caption = "Other", ;
		Pge3.Name = "pageComment", ;
		Pge3.PageOrder = 4, ;
		Pge4.Caption = "Band", ;
		Pge4.Name = "pageBand", ;
		Pge4.PageOrder = 2
		*< END OBJECT: ClassLib="frxcontrols.vcx" BaseClass="pageframe" />

	ADD OBJECT 'frame.pageBand.Paneldetail1' AS paneldetail WITH ;
		Height = 241, ;
		Left = 7, ;
		Name = "Paneldetail1", ;
		priority = 1, ;
		Top = 3, ;
		Width = 340, ;
		Shp1.Height = 220, ;
		Shp1.Left = 1, ;
		Shp1.Name = "Shp1", ;
		Shp1.Top = 8, ;
		chkNewColumn.Alignment = 0, ;
		chkNewColumn.Name = "chkNewColumn", ;
		chkNewPage.Alignment = 0, ;
		chkNewPage.Name = "chkNewPage", ;
		Lbl1.Name = "Lbl1", ;
		chkHasHeader.Alignment = 0, ;
		chkHasHeader.Name = "chkHasHeader", ;
		chkReprintHeader.Alignment = 0, ;
		chkReprintHeader.Name = "chkReprintHeader", ;
		chkResetPage.Alignment = 0, ;
		chkResetPage.Name = "chkResetPage", ;
		lblThreshold.Name = "lblThreshold", ;
		spnThreshold.Name = "spnThreshold", ;
		expTargetAlias.cmdExprBuilder.Name = "cmdExprBuilder", ;
		expTargetAlias.Left = 12, ;
		expTargetAlias.Name = "expTargetAlias", ;
		expTargetAlias.Top = 195, ;
		expTargetAlias.txtExpression.Name = "txtExpression", ;
		expTargetAlias.Width = 284, ;
		lblTargetAlias.Name = "lblTargetAlias"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageComment.Panelcommentuser1' AS panelcommentuser WITH ;
		Height = 197, ;
		Left = 7, ;
		Name = "Panelcommentuser1", ;
		Top = 3, ;
		Width = 364, ;
		shpUser.Left = 5, ;
		shpUser.Name = "shpUser", ;
		shpUser.Top = 102, ;
		shpUser.Width = 350, ;
		LBLCOMMENTTEXT.Height = 58, ;
		LBLCOMMENTTEXT.Left = 56, ;
		LBLCOMMENTTEXT.Name = "LBLCOMMENTTEXT", ;
		LBLCOMMENTTEXT.Top = 17, ;
		LBLCOMMENTTEXT.Width = 296, ;
		CMDCOMMENT.Left = 235, ;
		CMDCOMMENT.Name = "CMDCOMMENT", ;
		CMDCOMMENT.Top = 73, ;
		LBLUSERCAPTION.Left = 2, ;
		LBLUSERCAPTION.Name = "LBLUSERCAPTION", ;
		LBLUSERCAPTION.Top = 95, ;
		LBLUSERTEXT.Height = 64, ;
		LBLUSERTEXT.Left = 57, ;
		LBLUSERTEXT.Name = "LBLUSERTEXT", ;
		LBLUSERTEXT.Top = 113, ;
		LBLUSERTEXT.Width = 299, ;
		IMGCOMMENT.Height = 32, ;
		IMGCOMMENT.Name = "IMGCOMMENT", ;
		IMGCOMMENT.Width = 32, ;
		CMDUSER.Left = 235, ;
		CMDUSER.Name = "CMDUSER", ;
		CMDUSER.Top = 169, ;
		Shape1.Name = "Shape1", ;
		Shape1.Width = 350, ;
		LBLCOMMENTCAPTION.Name = "LBLCOMMENTCAPTION", ;
		IMGUSER.Height = 32, ;
		IMGUSER.Left = 8, ;
		IMGUSER.Name = "IMGUSER", ;
		IMGUSER.Top = 116, ;
		IMGUSER.Width = 32
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageComment.Panelmemberdata1' AS panelmemberdata WITH ;
		Height = 86, ;
		Left = 7, ;
		Name = "Panelmemberdata1", ;
		Top = 202, ;
		Width = 360, ;
		LBLSCRIPTTEXT.Height = 56, ;
		LBLSCRIPTTEXT.Left = 56, ;
		LBLSCRIPTTEXT.Name = "LBLSCRIPTTEXT", ;
		LBLSCRIPTTEXT.Top = 18, ;
		LBLSCRIPTTEXT.Width = 300, ;
		SHAPE4.Name = "SHAPE4", ;
		SHAPE4.Width = 350, ;
		CMDSCRIPT.Left = 235, ;
		CMDSCRIPT.Name = "CMDSCRIPT", ;
		CMDSCRIPT.Top = 60, ;
		IMGSCRIPT.Height = 32, ;
		IMGSCRIPT.Name = "IMGSCRIPT", ;
		IMGSCRIPT.Width = 32, ;
		LBLSCRIPTCAPTION.Name = "LBLSCRIPTCAPTION"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageGeneral.Panelband1' AS panelband WITH ;
		Left = 8, ;
		Name = "Panelband1", ;
		Top = 3, ;
		Width = 311, ;
		lblHeight.Name = "lblHeight", ;
		SPNHEIGHT.Name = "SPNHEIGHT", ;
		CHKCONSTANTHEIGHT.Alignment = 0, ;
		CHKCONSTANTHEIGHT.Name = "CHKCONSTANTHEIGHT", ;
		SHP1.Height = 108, ;
		SHP1.Left = 0, ;
		SHP1.Name = "SHP1", ;
		SHP1.Top = 80, ;
		SHP1.Width = 303, ;
		lblRunExpr.Name = "lblRunExpr", ;
		EXPENTRY.CMDEXPRBUILDER.Name = "CMDEXPRBUILDER", ;
		EXPENTRY.Height = 23, ;
		EXPENTRY.Left = 12, ;
		EXPENTRY.Name = "EXPENTRY", ;
		EXPENTRY.Top = 108, ;
		EXPENTRY.TXTEXPRESSION.Name = "TXTEXPRESSION", ;
		EXPENTRY.Width = 279, ;
		EXPEXIT.CMDEXPRBUILDER.Name = "CMDEXPRBUILDER", ;
		EXPEXIT.Height = 23, ;
		EXPEXIT.Left = 12, ;
		EXPEXIT.Name = "EXPEXIT", ;
		EXPEXIT.Top = 156, ;
		EXPEXIT.TXTEXPRESSION.Name = "TXTEXPRESSION", ;
		EXPEXIT.Width = 279, ;
		lblOnEntry.Name = "lblOnEntry", ;
		lblOnExit.Name = "lblOnExit"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageProtection.Panelbandprotection1' AS panelbandprotection WITH ;
		Height = 124, ;
		Left = 7, ;
		Name = "Panelbandprotection1", ;
		priority = 1, ;
		Top = 4, ;
		Width = 312, ;
		SHP1.Height = 112, ;
		SHP1.Left = 1, ;
		SHP1.Name = "SHP1", ;
		SHP1.Top = 8, ;
		SHP1.Width = 307, ;
		chkBandEdit.Alignment = 0, ;
		chkBandEdit.Name = "chkBandEdit", ;
		chkBandResize.Alignment = 0, ;
		chkBandResize.Name = "chkBandResize", ;
		LBL1.Name = "LBL1", ;
		Lbl2.Name = "Lbl2"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />
	
	PROCEDURE loadfromfrx
		*=====================================================================
		* LoadFromFrx()
		*
		* Read values from the FRX record(s) and configure the controls.
		*
		* Normally, the superclass method does everything. Here, we need
		* a little extra processing.
		*=====================================================================
		
		*---------------------------------------------------------------
		* Remove the Detail Band page if this is not a 
		* detail band:
		*---------------------------------------------------------------
		if THIS.frxEvent.OBJCODE <> FRX_OBJCOD_DETAIL
			THIS.frame.RemoveObject( "pageBand" ) 
		endif
		
		
		*---------------------------------------------------------------
		* Invoke the superclass method:
		* -- Calls each panel's LoadFromFrx()
		* -- Assigns .event and .frxCursor references
		* -- Removes protection panel
		* -- sets activePage:
		*---------------------------------------------------------------
		OkToContinue = dodefault() 
		if not m.OkToContinue
			return .F.
		endif
		
		*---------------------------------------------------------------
		* If we *are* a detail band, let's make 
		* that the default page coming in:
		*---------------------------------------------------------------
		if THIS.frxEvent.OBJCODE = FRX_OBJCOD_DETAIL
			THIS.PageToActivate = 2
		endif
		
		*---------------------------------------------------------------
		* Set title of dialog:
		*---------------------------------------------------------------
		THIS.Caption = this.frxevent.getTargetTypeText() + DLG_TITLE_BAND_LOC + DLG_TITLE_PROPERTIES_LOC
		
		if THIS.frxEvent.protected and ;
		   THIS.frxEvent.frxCursor.hasProtectionFlag( ORDER, FRX_PROTECT_BAND_NO_EDIT)
			
			THIS.Caption = THIS.Caption + DLG_TITLE_READONLY_SUFFIX_LOC
		
			THIS.frxEvent.setReloadChanges(.F.)
			
			*----------------------------------------------
			* CHANGE: Do not show dialog if PROTECT_NO_EDIT
			*----------------------------------------------
			OkToContinue = .F.
		
		endif
		return m.OkToContinue
	ENDPROC

	PROCEDURE frame.pageBand.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_BAND_LOC
		#ENDIF
		THIS.HelpContextID = UI_BAND_PROPS_BAND_HELP_ID
	ENDPROC

	PROCEDURE frame.pageComment.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_OTHER_LOC
		#ENDIF
		THIS.HelpContextID = UI_BAND_PROPS_OTHER_HELP_ID 
	ENDPROC

	PROCEDURE frame.pageGeneral.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_GENERAL_LOC
		#ENDIF
		THIS.HelpContextID = UI_BAND_PROPS_GENERAL_HELP_ID
	ENDPROC

	PROCEDURE frame.pageProtection.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_PROTECTION_LOC
		#ENDIF
		THIS.HelpContextID = UI_BAND_PROPS_PROTECTION_HELP_ID
	ENDPROC

ENDDEFINE

DEFINE CLASS fieldexprhandler AS frxhandlerform OF "frxbuilder.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="frame" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageGeneral.Panel" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageGeneral.PANELABSOLUTEPOSITIONING1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageGeneral.Panelfieldpositioning1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pagePrintWhen.panel" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageProtection.panel" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageProtection.Paneldesigntimelabel1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageCalculate.Panelcalculate1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageComment.Panelcommentuser1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageComment.Paneltooltip1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageComment.Panelmemberdata1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageStyle.panel" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageFormat.Panelfieldformat1" UniqueID="" Timestamp="" />

	#INCLUDE "frxbuilder.h"
	BorderStyle = 3
	Caption = "Field/Expression"
	DoCreate = .T.
	Height = 412
	Name = "fieldexprhandler"
	Width = 453
	grabber.Height = 11
	grabber.Left = 168
	grabber.Name = "grabber"
	grabber.Top = 384
	grabber.Width = 11
	frxcursor.Name = "frxcursor"
	cmdOK.Left = 237
	cmdOK.Name = "cmdOK"
	cmdOK.TabIndex = 2
	cmdOK.Top = 375
	cmdCancel.Left = 318
	cmdCancel.Name = "cmdCancel"
	cmdCancel.TabIndex = 3
	cmdCancel.Top = 375
	cmdHelp.Left = 80
	cmdHelp.Name = "cmdHelp"
	cmdHelp.Top = 368

	ADD OBJECT 'frame' AS pgfhandlerframe WITH ;
		autorefreshonpagechange = .T., ;
		ErasePage = .T., ;
		Height = 362, ;
		Left = 5, ;
		Name = "frame", ;
		PageCount = 7, ;
		TabIndex = 1, ;
		TabStyle = 1, ;
		Top = 6, ;
		Width = 391, ;
		Pge1.Caption = "General", ;
		Pge1.Name = "pageGeneral", ;
		Pge1.PageOrder = 1, ;
		Pge2.Caption = "Print when", ;
		Pge2.Name = "pagePrintWhen", ;
		Pge2.PageOrder = 4, ;
		Pge3.Caption = "Protection", ;
		Pge3.Name = "pageProtection", ;
		Pge3.PageOrder = 6, ;
		Pge4.Caption = "Calculate", ;
		Pge4.Name = "pageCalculate", ;
		Pge4.PageOrder = 5, ;
		Pge5.Caption = "Other", ;
		Pge5.Name = "pageComment", ;
		Pge5.PageOrder = 7, ;
		Pge6.Caption = "Style", ;
		Pge6.Name = "pageStyle", ;
		Pge6.PageOrder = 2, ;
		Pge7.Caption = "Format", ;
		Pge7.Name = "pageFormat", ;
		Pge7.PageOrder = 3
		*< END OBJECT: ClassLib="frxcontrols.vcx" BaseClass="pageframe" />

	ADD OBJECT 'frame.pageCalculate.Panelcalculate1' AS panelcalculate WITH ;
		Left = 8, ;
		Name = "Panelcalculate1", ;
		Top = 7, ;
		Shp3.Name = "Shp3", ;
		CBOCALCULATE.Name = "CBOCALCULATE", ;
		Lbl5.Name = "Lbl5", ;
		Lbl3.Name = "Lbl3", ;
		cboReset.Name = "cboReset", ;
		Lbl6.Name = "Lbl6"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageComment.Panelcommentuser1' AS panelcommentuser WITH ;
		Height = 170, ;
		Left = 7, ;
		Name = "Panelcommentuser1", ;
		Top = 5, ;
		Width = 387, ;
		shpUser.Height = 2, ;
		shpUser.Left = 5, ;
		shpUser.Name = "shpUser", ;
		shpUser.Top = 87, ;
		shpUser.Width = 368, ;
		LBLCOMMENTTEXT.Height = 46, ;
		LBLCOMMENTTEXT.Left = 56, ;
		LBLCOMMENTTEXT.Name = "LBLCOMMENTTEXT", ;
		LBLCOMMENTTEXT.Width = 315, ;
		CMDCOMMENT.Left = 253, ;
		CMDCOMMENT.Name = "CMDCOMMENT", ;
		CMDCOMMENT.Top = 57, ;
		LBLUSERCAPTION.Left = 2, ;
		LBLUSERCAPTION.Name = "LBLUSERCAPTION", ;
		LBLUSERCAPTION.Top = 79, ;
		LBLUSERTEXT.Height = 49, ;
		LBLUSERTEXT.Left = 58, ;
		LBLUSERTEXT.Name = "LBLUSERTEXT", ;
		LBLUSERTEXT.Width = 317, ;
		IMGCOMMENT.Height = 32, ;
		IMGCOMMENT.Name = "IMGCOMMENT", ;
		IMGCOMMENT.Width = 32, ;
		CMDUSER.Left = 253, ;
		CMDUSER.Name = "CMDUSER", ;
		CMDUSER.Top = 134, ;
		Shape1.Height = 2, ;
		Shape1.Left = 5, ;
		Shape1.Name = "Shape1", ;
		Shape1.Top = 9, ;
		Shape1.Width = 368, ;
		LBLCOMMENTCAPTION.Name = "LBLCOMMENTCAPTION", ;
		IMGUSER.Height = 32, ;
		IMGUSER.Left = 8, ;
		IMGUSER.Name = "IMGUSER", ;
		IMGUSER.Top = 99, ;
		IMGUSER.Width = 32
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageComment.Panelmemberdata1' AS panelmemberdata WITH ;
		Height = 86, ;
		Left = 7, ;
		Name = "Panelmemberdata1", ;
		Top = 228, ;
		Width = 387, ;
		LBLSCRIPTTEXT.Height = 46, ;
		LBLSCRIPTTEXT.Left = 56, ;
		LBLSCRIPTTEXT.Name = "LBLSCRIPTTEXT", ;
		LBLSCRIPTTEXT.Width = 315, ;
		Shape4.Height = 2, ;
		Shape4.Left = 5, ;
		Shape4.Name = "Shape4", ;
		Shape4.Top = 9, ;
		Shape4.Width = 368, ;
		CMDSCRIPT.Left = 253, ;
		CMDSCRIPT.Name = "CMDSCRIPT", ;
		CMDSCRIPT.Top = 58, ;
		IMGSCRIPT.Height = 32, ;
		IMGSCRIPT.Name = "IMGSCRIPT", ;
		IMGSCRIPT.Width = 32, ;
		LBLSCRIPTCAPTION.Name = "LBLSCRIPTCAPTION"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageComment.Paneltooltip1' AS paneltooltip WITH ;
		Height = 78, ;
		Left = 7, ;
		Name = "Paneltooltip1", ;
		Top = 160, ;
		Width = 391, ;
		SHPUSER.Height = 2, ;
		SHPUSER.Left = 5, ;
		SHPUSER.Name = "SHPUSER", ;
		SHPUSER.Top = 9, ;
		SHPUSER.Width = 369, ;
		lblTooltipText.Height = 36, ;
		lblTooltipText.Left = 56, ;
		lblTooltipText.Name = "lblTooltipText", ;
		lblTooltipText.Width = 319, ;
		CmdTooltip.Left = 253, ;
		CmdTooltip.Name = "CmdTooltip", ;
		CmdTooltip.Top = 47, ;
		lblTooltipCaption.Name = "lblTooltipCaption", ;
		imgTooltip.Height = 32, ;
		imgTooltip.Name = "imgTooltip", ;
		imgTooltip.Width = 32
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageFormat.Panelfieldformat1' AS panelfieldformat WITH ;
		Left = 10, ;
		Name = "Panelfieldformat1", ;
		priority = 2, ;
		Top = 14, ;
		Lbl1.Name = "Lbl1", ;
		SHP1.Name = "SHP1", ;
		txtFormat.Name = "txtFormat", ;
		LBL3.Name = "LBL3", ;
		opgDataType.Name = "opgDataType", ;
		opgDataType.OPT1.Left = 5, ;
		opgDataType.OPT1.Name = "OPT1", ;
		opgDataType.OPT1.Top = 5, ;
		opgDataType.OPT2.Left = 120, ;
		opgDataType.OPT2.Name = "OPT2", ;
		opgDataType.OPT2.Top = 4, ;
		opgDataType.OPT3.Left = 225, ;
		opgDataType.OPT3.Name = "OPT3", ;
		opgDataType.OPT3.Top = 4, ;
		LBL2.Name = "LBL2", ;
		cboStringTrimMode.Name = "cboStringTrimMode", ;
		cntCharFormat.CHKBRITISHDATE.Alignment = 0, ;
		cntCharFormat.CHKBRITISHDATE.Name = "CHKBRITISHDATE", ;
		cntCharFormat.CHKSETDATE.Alignment = 0, ;
		cntCharFormat.CHKSETDATE.Name = "CHKSETDATE", ;
		cntCharFormat.CHKUPPER.Alignment = 0, ;
		cntCharFormat.CHKUPPER.Name = "CHKUPPER", ;
		cntCharFormat.LBL1.Name = "LBL1", ;
		cntCharFormat.LBL2.Name = "LBL2", ;
		cntCharFormat.Name = "cntCharFormat", ;
		cntCharFormat.OPGIGNOREINPUTMASK.Name = "OPGIGNOREINPUTMASK", ;
		cntCharFormat.OPGIGNOREINPUTMASK.OPT1.Left = 15, ;
		cntCharFormat.OPGIGNOREINPUTMASK.OPT1.Name = "OPT1", ;
		cntCharFormat.OPGIGNOREINPUTMASK.OPT1.Top = 11, ;
		cntCharFormat.OPGIGNOREINPUTMASK.OPT2.Left = 15, ;
		cntCharFormat.OPGIGNOREINPUTMASK.OPT2.Name = "OPT2", ;
		cntCharFormat.OPGIGNOREINPUTMASK.OPT2.Top = 30, ;
		cntCharFormat.OPGJUSTIFY.Name = "OPGJUSTIFY", ;
		cntCharFormat.OPGJUSTIFY.OPT1.Left = 19, ;
		cntCharFormat.OPGJUSTIFY.OPT1.Name = "OPT1", ;
		cntCharFormat.OPGJUSTIFY.OPT1.Top = 14, ;
		cntCharFormat.OPGJUSTIFY.OPT2.Left = 19, ;
		cntCharFormat.OPGJUSTIFY.OPT2.Name = "OPT2", ;
		cntCharFormat.OPGJUSTIFY.OPT2.Top = 33, ;
		cntCharFormat.OPGJUSTIFY.opt3.Left = 19, ;
		cntCharFormat.OPGJUSTIFY.opt3.Name = "opt3", ;
		cntCharFormat.OPGJUSTIFY.opt3.Top = 52, ;
		cntNumFormat.CHKBLANKIFZERO.Alignment = 0, ;
		cntNumFormat.CHKBLANKIFZERO.Name = "CHKBLANKIFZERO", ;
		cntNumFormat.CHKBRITISHDATE.Alignment = 0, ;
		cntNumFormat.CHKBRITISHDATE.Name = "CHKBRITISHDATE", ;
		cntNumFormat.CHKCRIFPOSITIVE.Alignment = 0, ;
		cntNumFormat.CHKCRIFPOSITIVE.Name = "CHKCRIFPOSITIVE", ;
		cntNumFormat.CHKCURRENCY.Alignment = 0, ;
		cntNumFormat.CHKCURRENCY.Name = "CHKCURRENCY", ;
		cntNumFormat.CHKDBIFNEGATIVE.Alignment = 0, ;
		cntNumFormat.CHKDBIFNEGATIVE.Name = "CHKDBIFNEGATIVE", ;
		cntNumFormat.CHKLEADINGZEROS.Alignment = 0, ;
		cntNumFormat.CHKLEADINGZEROS.Name = "CHKLEADINGZEROS", ;
		cntNumFormat.CHKLEFTJUSTIFY.Alignment = 0, ;
		cntNumFormat.CHKLEFTJUSTIFY.Name = "CHKLEFTJUSTIFY", ;
		cntNumFormat.CHKNEGATIVE.Alignment = 0, ;
		cntNumFormat.CHKNEGATIVE.Name = "CHKNEGATIVE", ;
		cntNumFormat.CHKSCIENTIFIC.Alignment = 0, ;
		cntNumFormat.CHKSCIENTIFIC.Name = "CHKSCIENTIFIC", ;
		cntNumFormat.CHKSETDATE.Alignment = 0, ;
		cntNumFormat.CHKSETDATE.Name = "CHKSETDATE", ;
		cntNumFormat.Name = "cntNumFormat", ;
		cntDateFormat.CHKBLANKIFZERO.Alignment = 0, ;
		cntDateFormat.CHKBLANKIFZERO.Name = "CHKBLANKIFZERO", ;
		cntDateFormat.CHKBRITISHDATE.Alignment = 0, ;
		cntDateFormat.CHKBRITISHDATE.Name = "CHKBRITISHDATE", ;
		cntDateFormat.CHKSETDATE.Alignment = 0, ;
		cntDateFormat.CHKSETDATE.Name = "CHKSETDATE", ;
		cntDateFormat.CHKYL.Alignment = 0, ;
		cntDateFormat.CHKYL.Name = "CHKYL", ;
		cntDateFormat.CHKYS.Alignment = 0, ;
		cntDateFormat.CHKYS.Name = "CHKYS", ;
		cntDateFormat.Name = "cntDateFormat"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageGeneral.Panel' AS panelfieldexpr WITH ;
		Height = 66, ;
		Left = 8, ;
		Name = "Panel", ;
		TabIndex = 1, ;
		Top = 10, ;
		Width = 342, ;
		Lbl1.Name = "Lbl1", ;
		Lbl1.TabIndex = 1, ;
		objExpr.cmdExprBuilder.Left = 298, ;
		objExpr.cmdExprBuilder.Name = "cmdExprBuilder", ;
		objExpr.cmdExprBuilder.Top = 1, ;
		objExpr.Height = 46, ;
		objExpr.Left = 1, ;
		objExpr.Name = "objExpr", ;
		objExpr.TabIndex = 2, ;
		objExpr.txtExpression.Height = 41, ;
		objExpr.txtExpression.Left = 0, ;
		objExpr.txtExpression.Name = "txtExpression", ;
		objExpr.txtExpression.Top = 1, ;
		objExpr.txtExpression.Width = 293, ;
		objExpr.Width = 329
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageGeneral.PANELABSOLUTEPOSITIONING1' AS panelabsolutepositioning WITH ;
		Left = 9, ;
		Name = "PANELABSOLUTEPOSITIONING1", ;
		TabIndex = 3, ;
		Top = 196, ;
		Width = 329, ;
		Shp1.Left = 0, ;
		Shp1.Name = "Shp1", ;
		Shp1.Top = 8, ;
		Shp1.Width = 317, ;
		spnHeight.Left = 162, ;
		spnHeight.Name = "spnHeight", ;
		spnWidth.Left = 162, ;
		spnWidth.Name = "spnWidth", ;
		spnTop.Name = "spnTop", ;
		spnLeft.Name = "spnLeft", ;
		lblHeading.Name = "lblHeading", ;
		Lbl4.Left = 163, ;
		Lbl4.Name = "Lbl4", ;
		Lbl5.Left = 162, ;
		Lbl5.Name = "Lbl5", ;
		Lbl7.Name = "Lbl7", ;
		Lbl6.Name = "Lbl6"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageGeneral.Panelfieldpositioning1' AS panelfieldpositioning WITH ;
		Left = 7, ;
		Name = "Panelfieldpositioning1", ;
		TabIndex = 2, ;
		Top = 76, ;
		Width = 343, ;
		chkStretch.Alignment = 0, ;
		chkStretch.Left = 2, ;
		chkStretch.Name = "chkStretch", ;
		objPosition.gifBottom.Height = 34, ;
		objPosition.gifBottom.Name = "gifBottom", ;
		objPosition.gifBottom.Width = 31, ;
		objPosition.gifFloat.Height = 34, ;
		objPosition.gifFloat.Name = "gifFloat", ;
		objPosition.gifFloat.Width = 31, ;
		objPosition.gifTop.Height = 34, ;
		objPosition.gifTop.Name = "gifTop", ;
		objPosition.gifTop.Width = 31, ;
		objPosition.Label.Name = "Label", ;
		objPosition.Left = 2, ;
		objPosition.Name = "objPosition", ;
		objPosition.OptionGroup.Left = 0, ;
		objPosition.OptionGroup.Name = "OptionGroup", ;
		objPosition.OptionGroup.OPT1.Left = 66, ;
		objPosition.OptionGroup.OPT1.Name = "OPT1", ;
		objPosition.OptionGroup.OPT1.Top = 13, ;
		objPosition.OptionGroup.OPT2.Left = 66, ;
		objPosition.OptionGroup.OPT2.Name = "OPT2", ;
		objPosition.OptionGroup.OPT2.Top = 34, ;
		objPosition.OptionGroup.OPT3.Left = 66, ;
		objPosition.OptionGroup.OPT3.Name = "OPT3", ;
		objPosition.OptionGroup.OPT3.Top = 55, ;
		objPosition.OptionGroup.Top = 7, ;
		objPosition.OptionGroup.Width = 317, ;
		objPosition.Top = 1, ;
		objPosition.Width = 337
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pagePrintWhen.panel' AS panelprintwhen WITH ;
		Left = 10, ;
		Name = "panel", ;
		Top = 8, ;
		Width = 352, ;
		Shp1.Left = 0, ;
		Shp1.Name = "Shp1", ;
		Shp1.Top = 76, ;
		PrintRepeated.Left = 0, ;
		PrintRepeated.Name = "PrintRepeated", ;
		PrintRepeated.Opt1.Left = 10, ;
		PrintRepeated.Opt1.Name = "Opt1", ;
		PrintRepeated.Opt1.Top = 10, ;
		PrintRepeated.Opt2.Left = 10, ;
		PrintRepeated.Opt2.Name = "Opt2", ;
		PrintRepeated.Opt2.Top = 30, ;
		onFirstWholeBand.Alignment = 0, ;
		onFirstWholeBand.Name = "onFirstWholeBand", ;
		onGroupChange.Alignment = 0, ;
		onGroupChange.Name = "onGroupChange", ;
		group.Left = 40, ;
		group.Name = "group", ;
		group.Width = 272, ;
		onOverflow.Alignment = 0, ;
		onOverflow.Name = "onOverflow", ;
		removeBlank.Alignment = 0, ;
		removeBlank.Name = "removeBlank", ;
		cmdGetExpr.Name = "cmdGetExpr", ;
		LBL1.Name = "LBL1", ;
		Expression.Left = 0, ;
		Expression.Name = "Expression", ;
		Lbl2.Name = "Lbl2", ;
		LBL3.Name = "LBL3"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageProtection.panel' AS panelobjectprotection WITH ;
		Height = 273, ;
		Left = 9, ;
		Name = "panel", ;
		TabIndex = 1, ;
		Top = 9, ;
		Width = 330, ;
		Shp1.Height = 258, ;
		Shp1.Left = 0, ;
		Shp1.Name = "Shp1", ;
		Shp1.Top = 7, ;
		Shp1.Width = 325, ;
		chkObjectLock.Alignment = 0, ;
		chkObjectLock.Name = "chkObjectLock", ;
		chkObjectNoSelect.Alignment = 0, ;
		chkObjectNoSelect.Name = "chkObjectNoSelect", ;
		chkObjectNoDelete.Alignment = 0, ;
		chkObjectNoDelete.Name = "chkObjectNoDelete", ;
		chkObjectHidden.Alignment = 0, ;
		chkObjectHidden.Name = "chkObjectHidden", ;
		chkObjectNoEdit.Alignment = 0, ;
		chkObjectNoEdit.Name = "chkObjectNoEdit", ;
		LBL1.Name = "LBL1", ;
		Lbl2.Name = "Lbl2"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageProtection.Paneldesigntimelabel1' AS paneldesigntimelabel WITH ;
		Left = 24, ;
		Name = "Paneldesigntimelabel1", ;
		TabIndex = 2, ;
		Top = 212, ;
		Width = 289, ;
		LBL1.Name = "LBL1", ;
		txtDesignTimeLabel.Name = "txtDesignTimeLabel"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageStyle.panel' AS paneltextformat WITH ;
		Left = 9, ;
		Name = "panel", ;
		Top = 6, ;
		Width = 329, ;
		opgMode.Left = 0, ;
		opgMode.Name = "opgMode", ;
		opgMode.Opt1.Left = 15, ;
		opgMode.Opt1.Name = "Opt1", ;
		opgMode.Opt1.Top = 10, ;
		opgMode.Opt2.Left = 15, ;
		opgMode.Opt2.Name = "Opt2", ;
		opgMode.Opt2.Top = 31, ;
		opgMode.Width = 317, ;
		shpFontBorder.Name = "shpFontBorder", ;
		shpFontBorder.Width = 317, ;
		shpColorBorder.Name = "shpColorBorder", ;
		shpColorBorder.Width = 317, ;
		shpAlphaBorder.Left = 185, ;
		shpAlphaBorder.Name = "shpAlphaBorder", ;
		lblFont.Name = "lblFont", ;
		txtFont.Height = 21, ;
		txtFont.Left = 15, ;
		txtFont.Name = "txtFont", ;
		txtFont.Width = 262, ;
		cmdFont.Left = 284, ;
		cmdFont.Name = "cmdFont", ;
		chkOverrideCharset.Alignment = 0, ;
		chkOverrideCharset.Name = "chkOverrideCharset", ;
		lblColor.Name = "lblColor", ;
		CHKFOREDEFAULT.Alignment = 0, ;
		CHKFOREDEFAULT.Name = "CHKFOREDEFAULT", ;
		cmdForeColor.Left = 283, ;
		cmdForeColor.Name = "cmdForeColor", ;
		CHKBACKDEFAULT.Alignment = 0, ;
		CHKBACKDEFAULT.Name = "CHKBACKDEFAULT", ;
		cmdBackcolor.Left = 283, ;
		cmdBackcolor.Name = "cmdBackcolor", ;
		oFormatter.Left = 269, ;
		oFormatter.Name = "oFormatter", ;
		oFormatter.Top = 44, ;
		lblBackstyle.Name = "lblBackstyle", ;
		chkStrikethru.Alignment = 0, ;
		chkStrikethru.Name = "chkStrikethru", ;
		chkUnderline.Alignment = 0, ;
		chkUnderline.Left = 158, ;
		chkUnderline.Name = "chkUnderline", ;
		cntPreview.canvas.Height = 46, ;
		cntPreview.canvas.hozLine.Name = "hozLine", ;
		cntPreview.canvas.Left = 6, ;
		cntPreview.canvas.Name = "canvas", ;
		cntPreview.canvas.Text.Name = "Text", ;
		cntPreview.canvas.vertLine.Name = "vertLine", ;
		cntPreview.canvas.Width = 303, ;
		cntPreview.lblSample.Name = "lblSample", ;
		cntPreview.Left = 0, ;
		cntPreview.Name = "cntPreview", ;
		cntPreview.shpBorder.Left = 0, ;
		cntPreview.shpBorder.Name = "shpBorder", ;
		cntPreview.shpBorder.Top = 6, ;
		cntPreview.shpBorder.Width = 317, ;
		cntPreview.Width = 325, ;
		lblAlpha.Left = 192, ;
		lblAlpha.Name = "lblAlpha", ;
		lblAlpha.Top = 162, ;
		spnAlphaPen.Left = 239, ;
		spnAlphaPen.Name = "spnAlphaPen", ;
		cntBackColor.Left = 265, ;
		cntBackColor.Name = "cntBackColor", ;
		cntForeColor.Left = 265, ;
		cntForeColor.Name = "cntForeColor", ;
		spnAlphaFill.Left = 239, ;
		spnAlphaFill.Name = "spnAlphaFill", ;
		lblPen.Left = 194, ;
		lblPen.Name = "lblPen", ;
		lblFill.Left = 194, ;
		lblFill.Name = "lblFill"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />
	
	PROCEDURE loadfromfrx
		*=====================================================================
		* LoadFromFrx()
		*
		* Read values from the FRX record(s) and configure the controls
		*=====================================================================
		local OkToContinue
		
		*---------------------------------------------------------------
		* Call each panel's LoadFromFrx()
		* Assigns .event and .frxCursor references
		* Removes protection panel
		* sets activePage:
		*---------------------------------------------------------------
		OkToContinue = dodefault() 
		if not m.OkToContinue
			return .F.
		endif
		
		*---------------------------------------------------------------
		* Set the active page:
		*---------------------------------------------------------------
		*THIS.Frame.ActivePage = 1
		THIS.Frame.CurrentPage = 1
		
		*---------------------------------------------------------------
		* Event-specific actions:
		*   - Set title of dialog:
		*---------------------------------------------------------------
		do case
		case this.frxEvent.eventType = FRX_BLDR_EVENT_OBJECTCREATE
			THIS.Caption = DLG_TITLE_NEW_PREFIX_LOC + TARGET_FIELD_LOC + DLG_TITLE_PROPERTIES_LOC
		
		otherwise	
		*	THIS.Caption = TARGET_FIELD_LOC + ":  " + trim(EXPR)
			THIS.Caption = TARGET_FIELD_LOC + DLG_TITLE_PROPERTIES_LOC
		
		endcase
		if THIS.frxEvent.protected and ;
		   THIS.frxEvent.frxCursor.hasProtectionFlag( ORDER, FRX_PROTECT_OBJECT_NO_EDIT)
		
			THIS.Caption = THIS.Caption + DLG_TITLE_READONLY_SUFFIX_LOC
		
			*----------------------------------------------
			* CHANGE: Do not show dialog if PROTECT_NO_EDIT
			*----------------------------------------------
			OkToContinue = .F.
		
		endif
		return m.OkToContinue
	ENDPROC

	PROCEDURE frame.pageCalculate.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_CALCULATE_LOC
		#ENDIF
		THIS.HelpContextID = UI_CONTROL_PROPS_CALCULATE_HELP_ID    
	ENDPROC

	PROCEDURE frame.pageComment.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_OTHER_LOC
		#ENDIF
		THIS.HelpContextID = UI_CONTROL_PROPS_OTHER_HELP_ID        
	ENDPROC

	PROCEDURE frame.pageFormat.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_FORMAT_LOC
		#ENDIF
		
		THIS.HelpContextID = UI_CONTROL_PROPS_FORMAT_HELP_ID       
	ENDPROC

	PROCEDURE frame.pageGeneral.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_GENERAL_LOC
		#ENDIF
		THIS.HelpContextID = UI_CONTROL_PROPS_GENERAL_HELP_ID      
	ENDPROC

	PROCEDURE frame.pagePrintWhen.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_PRINTWHEN_LOC
		#ENDIF
		THIS.HelpContextID = UI_CONTROL_PROPS_PRINTWHEN_HELP_ID    
	ENDPROC

	PROCEDURE frame.pageProtection.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_PROTECTION_LOC
		#ENDIF
		THIS.HelpContextID = UI_CONTROL_PROPS_PROTECTION_HELP_ID   
	ENDPROC

	PROCEDURE frame.pageStyle.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_STYLE_LOC
		#ENDIF
		THIS.HelpContextID = UI_CONTROL_PROPS_STYLE_HELP_ID        
	ENDPROC

ENDDEFINE

DEFINE CLASS groupbandhandler AS frxhandlerform OF "frxbuilder.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="frame" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageGeneral.Panelgroupexpr1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageGeneral.Panelband1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageGrouping.Panelgrouping1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageProtection.Panelbandprotection1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageComment.Panelcommentuser1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageComment.Panelmemberdata1" UniqueID="" Timestamp="" />

	#INCLUDE "frxbuilder.h"
	DoCreate = .T.
	Height = 387
	Name = "groupbandhandler"
	Width = 548
	GRABBER.Height = 11
	GRABBER.Left = 302
	GRABBER.Name = "GRABBER"
	GRABBER.Top = 351
	GRABBER.Width = 11
	frxcursor.Name = "frxcursor"
	CMDOK.Left = 360
	CMDOK.Name = "CMDOK"
	CMDOK.Top = 348
	CMDCANCEL.Left = 440
	CMDCANCEL.Name = "CMDCANCEL"
	CMDCANCEL.Top = 348
	cmdHelp.Left = 317
	cmdHelp.Name = "cmdHelp"
	cmdHelp.Top = 354

	ADD OBJECT 'frame' AS pgfhandlerframe WITH ;
		ErasePage = .T., ;
		Height = 314, ;
		Left = 6, ;
		Name = "frame", ;
		PageCount = 4, ;
		Top = 6, ;
		Width = 534, ;
		Pge1.Caption = "General", ;
		Pge1.Name = "pageGeneral", ;
		Pge2.Caption = "Data Grouping", ;
		Pge2.Name = "pageGrouping", ;
		Pge3.Caption = "Protection", ;
		Pge3.Name = "pageProtection", ;
		Pge4.Caption = "Other", ;
		Pge4.Name = "pageComment"
		*< END OBJECT: ClassLib="frxcontrols.vcx" BaseClass="pageframe" />

	ADD OBJECT 'frame.pageComment.Panelcommentuser1' AS panelcommentuser WITH ;
		Anchor = 15, ;
		Height = 222, ;
		Left = 8, ;
		Name = "Panelcommentuser1", ;
		Top = 8, ;
		Width = 329, ;
		shpUser.Height = 2, ;
		shpUser.Left = 5, ;
		shpUser.Name = "shpUser", ;
		shpUser.Top = 99, ;
		shpUser.Width = 316, ;
		lblCommentText.Height = 69, ;
		lblCommentText.Left = 56, ;
		lblCommentText.Name = "lblCommentText", ;
		lblCommentText.Top = 17, ;
		lblCommentText.Width = 265, ;
		cmdComment.Left = 202, ;
		cmdComment.Name = "cmdComment", ;
		cmdComment.Top = 71, ;
		lblUserCaption.Left = 2, ;
		lblUserCaption.Name = "lblUserCaption", ;
		lblUserCaption.Top = 92, ;
		lblUserText.Height = 68, ;
		lblUserText.Left = 58, ;
		lblUserText.Name = "lblUserText", ;
		lblUserText.Top = 108, ;
		lblUserText.Width = 263, ;
		imgComment.Height = 32, ;
		imgComment.Name = "imgComment", ;
		imgComment.Width = 32, ;
		cmdUser.Left = 202, ;
		cmdUser.Name = "cmdUser", ;
		cmdUser.Top = 165, ;
		Shape1.Height = 2, ;
		Shape1.Left = 5, ;
		Shape1.Name = "Shape1", ;
		Shape1.Top = 9, ;
		Shape1.Width = 316, ;
		lblCommentCaption.Name = "lblCommentCaption", ;
		imgUser.Height = 32, ;
		imgUser.Left = 8, ;
		imgUser.Name = "imgUser", ;
		imgUser.Top = 112, ;
		imgUser.Width = 32
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageComment.Panelmemberdata1' AS panelmemberdata WITH ;
		Height = 86, ;
		Left = 8, ;
		Name = "Panelmemberdata1", ;
		Top = 192, ;
		Width = 326, ;
		LBLSCRIPTTEXT.Height = 63, ;
		LBLSCRIPTTEXT.Left = 56, ;
		LBLSCRIPTTEXT.Name = "LBLSCRIPTTEXT", ;
		LBLSCRIPTTEXT.Top = 20, ;
		LBLSCRIPTTEXT.Width = 265, ;
		SHAPE4.Height = 2, ;
		SHAPE4.Left = 5, ;
		SHAPE4.Name = "SHAPE4", ;
		SHAPE4.Top = 9, ;
		SHAPE4.Width = 316, ;
		CMDSCRIPT.Left = 202, ;
		CMDSCRIPT.Name = "CMDSCRIPT", ;
		CMDSCRIPT.Top = 60, ;
		IMGSCRIPT.Height = 32, ;
		IMGSCRIPT.Name = "IMGSCRIPT", ;
		IMGSCRIPT.Width = 32, ;
		LBLSCRIPTCAPTION.Name = "LBLSCRIPTCAPTION"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageGeneral.Panelband1' AS panelband WITH ;
		Left = 8, ;
		Name = "Panelband1", ;
		TabIndex = 2, ;
		Top = 57, ;
		ZOrderSet = 1, ;
		LBLHEIGHT.Name = "LBLHEIGHT", ;
		SPNHEIGHT.Name = "SPNHEIGHT", ;
		CHKCONSTANTHEIGHT.Alignment = 0, ;
		CHKCONSTANTHEIGHT.Name = "CHKCONSTANTHEIGHT", ;
		SHP1.Name = "SHP1", ;
		LBLRUNEXPR.Name = "LBLRUNEXPR", ;
		EXPENTRY.CMDEXPRBUILDER.Name = "CMDEXPRBUILDER", ;
		EXPENTRY.Name = "EXPENTRY", ;
		EXPENTRY.TXTEXPRESSION.Name = "TXTEXPRESSION", ;
		EXPEXIT.CMDEXPRBUILDER.Name = "CMDEXPRBUILDER", ;
		EXPEXIT.Name = "EXPEXIT", ;
		EXPEXIT.TXTEXPRESSION.Name = "TXTEXPRESSION", ;
		LBLONENTRY.Name = "LBLONENTRY", ;
		LBLONEXIT.Name = "LBLONEXIT"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageGeneral.Panelgroupexpr1' AS panelgroupexpr WITH ;
		Left = 7, ;
		Name = "Panelgroupexpr1", ;
		TabIndex = 1, ;
		Top = 6, ;
		ZOrderSet = 0, ;
		LBL1.Name = "LBL1", ;
		OBJEXPR.CMDEXPRBUILDER.Name = "CMDEXPRBUILDER", ;
		OBJEXPR.Name = "OBJEXPR", ;
		OBJEXPR.TXTEXPRESSION.Name = "TXTEXPRESSION"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageGrouping.Panelgrouping1' AS panelgrouping WITH ;
		Left = 5, ;
		Name = "Panelgrouping1", ;
		priority = 2, ;
		Top = 3, ;
		groupList.Name = "groupList", ;
		Lbl1.Name = "Lbl1", ;
		edtExpr.Name = "edtExpr", ;
		Lbl2.Name = "Lbl2", ;
		chkReprint.Alignment = 0, ;
		chkReprint.Name = "chkReprint", ;
		lblThreshold.Name = "lblThreshold", ;
		cmdAdd.Name = "cmdAdd", ;
		cmdGetExpr.Name = "cmdGetExpr", ;
		cmdRemove.Name = "cmdRemove", ;
		spnThreshold.Name = "spnThreshold", ;
		opgPaginate.Name = "opgPaginate", ;
		opgPaginate.Opt1.Left = 17, ;
		opgPaginate.Opt1.Name = "Opt1", ;
		opgPaginate.Opt1.Top = 12, ;
		opgPaginate.Opt2.Left = 17, ;
		opgPaginate.Opt2.Name = "Opt2", ;
		opgPaginate.Opt2.Top = 33, ;
		opgPaginate.Opt3.Left = 17, ;
		opgPaginate.Opt3.Name = "Opt3", ;
		opgPaginate.Opt3.Top = 54, ;
		opgPaginate.Opt4.Left = 17, ;
		opgPaginate.Opt4.Name = "Opt4", ;
		opgPaginate.Opt4.Top = 75, ;
		Lbl4.Name = "Lbl4"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageProtection.Panelbandprotection1' AS panelbandprotection WITH ;
		Height = 145, ;
		Left = 8, ;
		Name = "Panelbandprotection1", ;
		Top = 9, ;
		Width = 325, ;
		SHP1.Left = 1, ;
		SHP1.Name = "SHP1", ;
		SHP1.Top = 8, ;
		SHP1.Width = 312, ;
		CHKBANDEDIT.Alignment = 0, ;
		CHKBANDEDIT.Name = "CHKBANDEDIT", ;
		chkBandResize.Alignment = 0, ;
		chkBandResize.Name = "chkBandResize", ;
		Lbl1.Name = "Lbl1", ;
		Lbl2.Name = "Lbl2"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />
	
	PROCEDURE loadfromfrx
		*=====================================================================
		* LoadFromFrx()
		*
		* Read values from the FRX record(s) and configure the controls.
		*
		*=====================================================================
		local OkToContinue
		
		*---------------------------------------------------------------
		* Invoke the superclass method:
		* -- Calls each panel's LoadFromFrx()
		* -- Assigns .event and .frxCursor references
		* -- sets activePage:
		*---------------------------------------------------------------
		OkToContinue = dodefault() 
		if not m.OkToContinue
			return .F.
		endif
		
		*---------------------------------------------------------------
		* Set title of dialog:
		*---------------------------------------------------------------
		THIS.Caption = this.frxevent.getTargetTypeText() + DLG_TITLE_BAND_LOC + DLG_TITLE_PROPERTIES_LOC
		
		if THIS.frxEvent.protected and ;
		   THIS.frxEvent.frxCursor.hasProtectionFlag( ORDER, FRX_PROTECT_BAND_NO_EDIT)
		
			THIS.Caption = THIS.Caption + DLG_TITLE_READONLY_SUFFIX_LOC
			*----------------------------------------------
			* CHANGE: Do not show dialog if PROTECT_NO_EDIT
			*----------------------------------------------
			OkToContinue = .F.
		endif
		return m.OkToContinue
	ENDPROC

	PROCEDURE frame.Click
		*---------------------------------------------------
		* This code deals with ensuring that inter-related 
		* tabs reflect changes.
		*
		* Assumptions: 
		*   - oControl will be an instance of frxPanel
		*
		* Possible checks:
		*   use THISFORM.isInstanceOf('frxPanel',oControl)
		*
		*---------------------------------------------------
		if THIS.CurrentPage <> THIS.ActivePage
		
			local oControl
		
			if THIS.CurrentPage > 0
		
				for each oControl in THIS.Pages(THIS.CurrentPage).Controls
					*----------------------------------------------
					* Fix for SP1: Does not rely on panel control
					* being subclasses from frxPanel; rather, uses 
					* reflection instead:
					*----------------------------------------------
					if pemstatus( m.oControl, "SaveToFrx", 5 ) 
						oControl.SaveToFrx()
					endif
				endfor	
		
				for each oControl in THIS.Pages(THIS.ActivePage).Controls
					*----------------------------------------------
					* Fix for SP1: Does not rely on panel control
					* being subclasses from frxPanel; rather, uses 
					* reflection instead:
					*----------------------------------------------
					if pemstatus( m.oControl, "LoadFromFrx", 5 ) 
						oControl.LoadFromFrx()
					endif
				endfor
		
			endif
			THIS.CurrentPage = THIS.ActivePage
		endif
	ENDPROC

	PROCEDURE frame.pageComment.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_OTHER_LOC
		#ENDIF
		THIS.HelpContextID = UI_BAND_PROPS_OTHER_HELP_ID           
	ENDPROC

	PROCEDURE frame.pageGeneral.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_GENERAL_LOC
		#ENDIF
		THIS.HelpContextID = UI_BAND_PROPS_GENERAL_HELP_ID
	ENDPROC

	PROCEDURE frame.pageGrouping.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_DATAGROUP_LOC
		#ENDIF
		THIS.HelpContextID = UI_REPORT_PROPS_DATAGROUP_HELP_ID     
	ENDPROC

	PROCEDURE frame.pageProtection.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_PROTECTION_LOC
		#ENDIF
		THIS.HelpContextID = UI_BAND_PROPS_PROTECTION_HELP_ID
	ENDPROC

ENDDEFINE

DEFINE CLASS multiselecthandler AS frxhandlerform OF "frxbuilder.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Frame" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Frame.pagMulti.panel" UniqueID="" Timestamp="" />

	#INCLUDE "frxbuilder.h"
	BorderStyle = 3
	DoCreate = .T.
	Height = 444
	MaxButton = .T.
	Name = "multiselecthandler"
	Width = 415
	WindowState = 0
	grabber.Height = 11
	grabber.Left = 40
	grabber.Name = "grabber"
	grabber.Top = 400
	grabber.Width = 11
	frxcursor.Name = "frxcursor"
	cmdOK.Left = 228
	cmdOK.Name = "cmdOK"
	cmdOK.Top = 412
	cmdCancel.Left = 324
	cmdCancel.Name = "cmdCancel"
	cmdCancel.Top = 412
	cmdHelp.Left = 280
	cmdHelp.Name = "cmdHelp"
	cmdHelp.Top = 388

	ADD OBJECT 'Frame' AS pgfhandlerframe WITH ;
		ErasePage = .T., ;
		Height = 367, ;
		Left = 9, ;
		Name = "Frame", ;
		PageCount = 1, ;
		Top = 9, ;
		Width = 375, ;
		Pge1.Caption = "Selection", ;
		Pge1.Name = "pagMulti"
		*< END OBJECT: ClassLib="frxcontrols.vcx" BaseClass="pageframe" />

	ADD OBJECT 'Frame.pagMulti.panel' AS panelmultiselect WITH ;
		Anchor = 15, ;
		Height = 317, ;
		Left = 8, ;
		Name = "panel", ;
		Top = 6, ;
		Width = 359, ;
		lstGroupItems.Height = 242, ;
		lstGroupItems.Left = 1, ;
		lstGroupItems.Name = "lstGroupItems", ;
		lstGroupItems.Width = 351, ;
		LBL1.Name = "LBL1", ;
		obgSortOrder.Height = 33, ;
		obgSortOrder.Left = 2, ;
		obgSortOrder.Name = "obgSortOrder", ;
		obgSortOrder.opt1.Left = 9, ;
		obgSortOrder.opt1.Name = "opt1", ;
		obgSortOrder.opt1.Top = 11, ;
		obgSortOrder.opt2.Left = 96, ;
		obgSortOrder.opt2.Name = "opt2", ;
		obgSortOrder.opt2.Top = 11, ;
		obgSortOrder.Top = 275, ;
		obgSortOrder.Width = 204, ;
		Lbl2.Left = 8, ;
		Lbl2.Name = "Lbl2", ;
		Lbl2.Top = 268, ;
		Lbl4.Name = "Lbl4", ;
		cmdUnselect.Left = 216, ;
		cmdUnselect.Name = "cmdUnselect", ;
		cmdUnselect.Top = 280
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />
	
	PROCEDURE canceltofrx
		dodefault()
		THIS.frxEvent.SetReloadChanges(.F.)
	ENDPROC

	PROCEDURE Init
		DoDefault()
		*----------------------------------------
		* Override the default HandlerForm property:
		*----------------------------------------
		THIS.BorderStyle = 3
		
	ENDPROC

	PROCEDURE loadfromfrx
		*=======================================================================
		* LoadFromFrx()
		*
		* Read values in from the FRX
		*
		* In this method, we iterate through the container objects, calling 
		* their .LoadToFRX() methods.
		*
		* DELIBERATE OVERRIDE OF PARENT CLASS METHOD
		*=======================================================================
		local OkToContinue
		OkToContinue = .T.
		
		THIS.Caption = TARGET_MULTISELECT_LOC
		
		local curSel, curRec, cPageName
		curSel = select(0)
		select frxRegistry
		curRec = recno()
		
		*---------------------------------------------------------------
		* Load up additional pages from "M" classes in the registry:
		* DEPRECATED: Included for backward-compatibility only
		*---------------------------------------------------------------
		scan for REC_TYPE = HANDLREG_MULTITAB
			if THIS.Frame.NewRegisteredObject(sys(2015),trim(HNDL_CLASS),trim(HNDL_LIB))
				THIS.HasAdditionalTabs = .T.
			endif
		endscan
		
		*---------------------------------------------------------------
		* Load up additional pages from "T" classes in the registry:
		*---------------------------------------------------------------
		scan for REC_TYPE = HANDLREG_EXTRATAB ;
			and inlist( EVENTTYPE, THIS.frxEvent.EventType, -1 ) ;
			and (inlist( OBJTYPE,   THIS.frxEvent.ObjType,  -1 ) ;
		    	or (OBJTYPE = FRX_OBJTYPE_LAYOUTCONTROLS AND THIS.frxcursor.IsLayoutControl(THIS.frxEvent.ObjType))) ;
			and inlist( OBJCODE,   THIS.frxEvent.ObjCode,   -1 ) ;
			and not deleted()
		
			cPageName = 'T'+sys(2015)
		
			if THIS.Frame.NewRegisteredObject( m.cPageName, trim(HNDL_CLASS),trim(HNDL_LIB))
		
				*------------------------------------------------
				* Enhancement for SP2:
				* Allow setting of PageOrder thru the FLTR_ORDR
				* column. Note that it might be C(1) or I 
				*------------------------------------------------
				if val(trans(FLTR_ORDR)) > 0	
					THIS.Frame.Pages( THIS.Frame.PageCount ).PageOrder = min(THIS.Frame.PageCount,max(1,val(trans(FLTR_ORDR))))
				endif
				
				THIS.HasAdditionalTabs = .T.
				
			endif
		endscan     
		
		*----------------------------------------------------------------
		* New for SP2: Sync up the fonts if there are any new tabs
		*----------------------------------------------------------------
		if THIS.HasAdditionalTabs 
			THIS.CheckForLargeFonts()
		endif
		
		go m.curRec
		select (m.curSel)
		
		
		select frx
		local oPage, oPanel, lSkip
		for each oPage in THIS.Frame.Pages foxobject
			for each oPanel in oPage.Controls foxobject
				if oPanel.BaseClass = "Container" 
		
					if pemstatus( oPanel, "frxCursor", 5 )
						oPanel.frxCursor = THIS.frxEvent.frxCursor
					endif
					if pemstatus( oPanel, "event", 5 )
						oPanel.event     = THIS.frxEvent 
					endif
					if pemstatus( oPanel, "LoadFromFrx", 5 )
						OkToContinue = m.OkToContinue and oPanel.LoadFromFrx()					
					endif
				endif
			endfor	
		endfor
		
		THIS.PageToActivate = 1
		*THIS.frame.ActivePage = 1
		
		return m.OkToContinue
		
	ENDPROC

	PROCEDURE savetofrx
		*=======================================================================
		* SaveToFrx()
		*
		* Write values back to the FRX
		*
		*=======================================================================
		return dodefault()
		
		
		
		*=======================================================================
		* TODO: TAKE OUT EVERYTHING BELOW
		*=======================================================================
		
		
		
		*-------------------------------------------------------------
		* instrumenting the xbase code
		*-------------------------------------------------------------
		if DEBUG_WAITMSG_WHILE_EXECUTING
			wait window "Saving changes..." nowait
		endif
		
		*-------------------------------------------------------------
		* Call each panel's SaveToFrx() method:
		* This method returns .T. if ok to exit the dialog:
		*-------------------------------------------------------------
		if not THIS.Frame.pagMulti.panel.SaveToFrx()
			wait clear
			return .F.
		endif
		
		if THIS.frame.pagProperties.chkApplyProtection.value
			if not THIS.Frame.pagProperties.panelProtection.SaveToFrx()
				wait clear
				return .F.
			endif
		
			*-----------------------------------------------------
			* apply the protection flags to all selected objects:
			*-----------------------------------------------------
			select frx
			local curRec
			curRec = recno()
			scan for CURPOS and recno() > 1
				if OBJTYPE <> FRX_OBJTYP_GROUP
					replace ORDER with multibuff.ORDER
				endif
			endscan	
			THIS.frxEvent.frxCursor.goRec(m.curRec,"frx")
		endif
		
		if THIS.frame.pagProperties.chkApplyPrintWhen.value
			if not THIS.Frame.pagProperties.panelMultiPrintWhen.SaveToFrx()
				wait clear
				return .F.
			endif
		
			* Create the objects cursor
			THIS.frxEvent.frxCursor.CreateObjectCursor()
		
			*-----------------------------------------------------
			* apply the PrintWhen condition to all selected objects:
			*-----------------------------------------------------
			select frx
			local curRec
			curRec = recno()
			scan for CURPOS and recno() > 1
		
				if OBJTYPE = FRX_OBJTYP_GROUP
					*----------------------------------
					* Ignore aggregated element groups:
					*----------------------------------
					loop
				endif
		
				*-----------------------
				* Print When Expression:
				*-----------------------
				replace SUPEXPR with multibuff.SUPEXPR
				
				*----------------------------
				* Remove line/space if blank. 
				* This value can only be set if the object does not span bands 
				* and is not in a Column Footer.
				*----------------------------
				select objects
		
				*----------------------------------------- Does it span between bands?
				locate for UNIQUEID = frx.UNIQUEID
				if objects.START_BAND_ID = objects.END_BAND_ID
		
					select bands
		
					*------------------------------------- Is it in a column footer?
					locate for UNIQUEID = objects.START_BAND_ID
					if not inlist( bands.OBJCODE, FRX_OBJCOD_COLFOOTER )
						select frx
						replace NOREPEAT with multibuff.NOREPEAT
					endif
		
				endif						
				select frx
			endscan	
		
			THIS.frxEvent.frxCursor.goRec(m.curRec,"frx")
		endif
		
		*-------------------------------------------------------------
		* Call each additional panel's SaveToFrx() method:
		*-------------------------------------------------------------
		local oPage, oPanel
		for each oPage in THIS.Frame.Pages foxobject
		
			if inlist( oPage.Name, "pagMulti", "pagProperties" )
				* We did these ones up front:
				loop
			endif
		
			for each oPanel in oPage.Controls foxobject
				if oPanel.BaseClass = "Container" and pemstatus( oPanel, "SaveToFrx", 5 )
					if not oPanel.SaveToFrx()
						wait clear
						return .F.
					endif
				endif
			endfor
		endfor
		
		*-------------------------------------------------------------
		* Clean up and exit:
		*-------------------------------------------------------------
		use in multibuff
		
		THIS.frxEvent.setHandledByBuilder(.T.)
		THIS.frxEvent.setReloadChanges(.T.)
		
		return .T.						 
		
	ENDPROC

	PROCEDURE Frame.Click
		*---------------------------------------------------
		* OVERRIDE the default behavior - do not allow
		* automatic refresh of control panels.
		*---------------------------------------------------
		return 
		
	ENDPROC

	PROCEDURE Frame.pagMulti.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_SELECTION_LOC
		#ENDIF
		THIS.HelpContextID = UI_MULTI_PROPS_SELECTION_HELP_ID      
	ENDPROC

ENDDEFINE

DEFINE CLASS pictureboundhandler AS frxhandlerform OF "frxbuilder.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="frame" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageGeneral.Panelpicturebound1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageGeneral.Panelpicturepositioning1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageGeneral.Panelabsolutepositioning1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pagePrintWhen.panel" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageProtection.panel" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageComment.Panelcommentuser1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageComment.Paneltooltip1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageComment.Panelmemberdata1" UniqueID="" Timestamp="" />

	#INCLUDE "frxbuilder.h"
	BorderStyle = 3
	Caption = "Picture / Bound"
	DoCreate = .T.
	Height = 521
	Name = "pictureboundhandler"
	Width = 382
	grabber.Height = 11
	grabber.Left = 74
	grabber.Name = "grabber"
	grabber.Top = 438
	grabber.Width = 11
	frxcursor.Name = "frxcursor"
	CMDOK.Left = 143
	CMDOK.Name = "CMDOK"
	CMDOK.TabIndex = 2
	CMDOK.Top = 480
	CMDCANCEL.Left = 224
	CMDCANCEL.Name = "CMDCANCEL"
	CMDCANCEL.TabIndex = 3
	CMDCANCEL.Top = 480
	cmdHelp.Left = 288
	cmdHelp.Name = "cmdHelp"
	cmdHelp.Top = 468

	ADD OBJECT 'frame' AS pgfhandlerframe WITH ;
		ErasePage = .T., ;
		Height = 464, ;
		Left = 6, ;
		Name = "frame", ;
		PageCount = 4, ;
		TabIndex = 1, ;
		Top = 12, ;
		Width = 354, ;
		Pge1.Caption = "General", ;
		Pge1.Name = "pageGeneral", ;
		Pge2.Caption = "Print when", ;
		Pge2.Name = "pagePrintWhen", ;
		Pge3.Caption = "Protection", ;
		Pge3.Name = "pageProtection", ;
		Pge4.Caption = "Other", ;
		Pge4.Name = "pageComment"
		*< END OBJECT: ClassLib="frxcontrols.vcx" BaseClass="pageframe" />

	ADD OBJECT 'frame.pageComment.Panelcommentuser1' AS panelcommentuser WITH ;
		Height = 213, ;
		Left = 7, ;
		Name = "Panelcommentuser1", ;
		Top = 7, ;
		Width = 338, ;
		shpUser.Left = 5, ;
		shpUser.Name = "shpUser", ;
		shpUser.Top = 111, ;
		shpUser.Width = 322, ;
		LBLCOMMENTTEXT.Height = 68, ;
		LBLCOMMENTTEXT.Left = 56, ;
		LBLCOMMENTTEXT.Name = "LBLCOMMENTTEXT", ;
		LBLCOMMENTTEXT.Top = 17, ;
		LBLCOMMENTTEXT.Width = 270, ;
		CMDCOMMENT.Left = 208, ;
		CMDCOMMENT.Name = "CMDCOMMENT", ;
		CMDCOMMENT.Top = 77, ;
		LBLUSERCAPTION.Left = 2, ;
		LBLUSERCAPTION.Name = "LBLUSERCAPTION", ;
		LBLUSERCAPTION.Top = 104, ;
		LBLUSERTEXT.Height = 67, ;
		LBLUSERTEXT.Left = 58, ;
		LBLUSERTEXT.Name = "LBLUSERTEXT", ;
		LBLUSERTEXT.Top = 122, ;
		LBLUSERTEXT.Width = 272, ;
		IMGCOMMENT.Height = 32, ;
		IMGCOMMENT.Name = "IMGCOMMENT", ;
		IMGCOMMENT.Width = 32, ;
		CMDUSER.Left = 208, ;
		CMDUSER.Name = "CMDUSER", ;
		CMDUSER.Top = 180, ;
		Shape1.Name = "Shape1", ;
		Shape1.Width = 322, ;
		LBLCOMMENTCAPTION.Name = "LBLCOMMENTCAPTION", ;
		IMGUSER.Height = 32, ;
		IMGUSER.Left = 8, ;
		IMGUSER.Name = "IMGUSER", ;
		IMGUSER.Top = 124, ;
		IMGUSER.Width = 32
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageComment.Panelmemberdata1' AS panelmemberdata WITH ;
		Height = 106, ;
		Left = 7, ;
		Name = "Panelmemberdata1", ;
		Top = 320, ;
		Width = 338, ;
		LBLSCRIPTTEXT.Height = 64, ;
		LBLSCRIPTTEXT.Left = 56, ;
		LBLSCRIPTTEXT.Name = "LBLSCRIPTTEXT", ;
		LBLSCRIPTTEXT.Top = 18, ;
		LBLSCRIPTTEXT.Width = 274, ;
		Shape4.Name = "Shape4", ;
		Shape4.Width = 322, ;
		CMDSCRIPT.Left = 208, ;
		CMDSCRIPT.Name = "CMDSCRIPT", ;
		CMDSCRIPT.Top = 80, ;
		IMGSCRIPT.Height = 32, ;
		IMGSCRIPT.Name = "IMGSCRIPT", ;
		IMGSCRIPT.Width = 32, ;
		LBLSCRIPTCAPTION.Name = "LBLSCRIPTCAPTION"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageComment.Paneltooltip1' AS paneltooltip WITH ;
		Height = 100, ;
		Left = 7, ;
		Name = "Paneltooltip1", ;
		Top = 217, ;
		Width = 338, ;
		SHPUSER.Name = "SHPUSER", ;
		SHPUSER.Width = 322, ;
		lblTooltipText.Height = 59, ;
		lblTooltipText.Left = 56, ;
		lblTooltipText.Name = "lblTooltipText", ;
		lblTooltipText.Top = 17, ;
		lblTooltipText.Width = 274, ;
		CmdTooltip.Left = 208, ;
		CmdTooltip.Name = "CmdTooltip", ;
		CmdTooltip.Top = 73, ;
		lblTooltipCaption.Name = "lblTooltipCaption", ;
		imgTooltip.Height = 32, ;
		imgTooltip.Name = "imgTooltip", ;
		imgTooltip.Width = 32
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageGeneral.Panelabsolutepositioning1' AS panelabsolutepositioning WITH ;
		Left = 8, ;
		Name = "Panelabsolutepositioning1", ;
		TabIndex = 3, ;
		Top = 315, ;
		Width = 318, ;
		SHP1.Left = 1, ;
		SHP1.Name = "SHP1", ;
		SHP1.Top = 8, ;
		SHP1.Width = 313, ;
		SPNHEIGHT.Left = 157, ;
		SPNHEIGHT.Name = "SPNHEIGHT", ;
		SPNWIDTH.Left = 157, ;
		SPNWIDTH.Name = "SPNWIDTH", ;
		SPNTOP.Name = "SPNTOP", ;
		SPNLEFT.Name = "SPNLEFT", ;
		LBLHEADING.Name = "LBLHEADING", ;
		LBL4.Left = 158, ;
		LBL4.Name = "LBL4", ;
		LBL5.Left = 157, ;
		LBL5.Name = "LBL5", ;
		LBL7.Name = "LBL7", ;
		LBL6.Name = "LBL6"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageGeneral.Panelpicturebound1' AS panelpicturebound WITH ;
		Left = 7, ;
		Name = "Panelpicturebound1", ;
		TabIndex = 1, ;
		Top = 9, ;
		PICTURESOURCE.Name = "PICTURESOURCE", ;
		PICTURESOURCE.OPT1.Left = 9, ;
		PICTURESOURCE.OPT1.Name = "OPT1", ;
		PICTURESOURCE.OPT1.Top = 15, ;
		PICTURESOURCE.OPT2.Left = 9, ;
		PICTURESOURCE.OPT2.Name = "OPT2", ;
		PICTURESOURCE.OPT2.Top = 36, ;
		PICTURESOURCE.OPT3.Left = 9, ;
		PICTURESOURCE.OPT3.Name = "OPT3", ;
		PICTURESOURCE.OPT3.Top = 57, ;
		TXTLOCATOR.Name = "TXTLOCATOR", ;
		CMDLOCATE.Name = "CMDLOCATE", ;
		CHKCENTERED.Alignment = 0, ;
		CHKCENTERED.Name = "CHKCENTERED", ;
		LBL3.Name = "LBL3", ;
		LBL1.Name = "LBL1", ;
		CBOPICTUREMODE.Name = "CBOPICTUREMODE", ;
		LBL2.Name = "LBL2"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageGeneral.Panelpicturepositioning1' AS panelpicturepositioning WITH ;
		Left = 8, ;
		Name = "Panelpicturepositioning1", ;
		TabIndex = 2, ;
		Top = 224, ;
		Width = 317, ;
		OBJPOSITION.GIFBOTTOM.Height = 34, ;
		OBJPOSITION.GIFBOTTOM.Name = "GIFBOTTOM", ;
		OBJPOSITION.GIFBOTTOM.Width = 31, ;
		OBJPOSITION.GIFFLOAT.Height = 34, ;
		OBJPOSITION.GIFFLOAT.Name = "GIFFLOAT", ;
		OBJPOSITION.GIFFLOAT.Width = 31, ;
		OBJPOSITION.GIFTOP.Height = 34, ;
		OBJPOSITION.GIFTOP.Name = "GIFTOP", ;
		OBJPOSITION.GIFTOP.Width = 31, ;
		OBJPOSITION.Label.Name = "Label", ;
		OBJPOSITION.Left = 0, ;
		OBJPOSITION.Name = "OBJPOSITION", ;
		OBJPOSITION.OptionGroup.Left = 0, ;
		OBJPOSITION.OptionGroup.Name = "OptionGroup", ;
		OBJPOSITION.OptionGroup.OPT1.Left = 66, ;
		OBJPOSITION.OptionGroup.OPT1.Name = "OPT1", ;
		OBJPOSITION.OptionGroup.OPT1.Top = 13, ;
		OBJPOSITION.OptionGroup.OPT2.Left = 66, ;
		OBJPOSITION.OptionGroup.OPT2.Name = "OPT2", ;
		OBJPOSITION.OptionGroup.OPT2.Top = 34, ;
		OBJPOSITION.OptionGroup.OPT3.Left = 66, ;
		OBJPOSITION.OptionGroup.OPT3.Name = "OPT3", ;
		OBJPOSITION.OptionGroup.OPT3.Top = 55, ;
		OBJPOSITION.OptionGroup.Top = 7, ;
		OBJPOSITION.OptionGroup.Width = 313, ;
		OBJPOSITION.Top = 0, ;
		OBJPOSITION.Width = 317
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pagePrintWhen.panel' AS panelprintwhen WITH ;
		Height = 271, ;
		Left = 8, ;
		Name = "panel", ;
		Top = 9, ;
		SHP1.Left = 0, ;
		SHP1.Name = "SHP1", ;
		SHP1.Top = 76, ;
		PRINTREPEATED.Left = 0, ;
		PRINTREPEATED.Name = "PRINTREPEATED", ;
		PRINTREPEATED.OPT1.Left = 10, ;
		PRINTREPEATED.OPT1.Name = "OPT1", ;
		PRINTREPEATED.OPT1.Top = 12, ;
		PRINTREPEATED.OPT2.Left = 10, ;
		PRINTREPEATED.OPT2.Name = "OPT2", ;
		PRINTREPEATED.OPT2.Top = 33, ;
		ONFIRSTWHOLEBAND.Alignment = 0, ;
		ONFIRSTWHOLEBAND.Name = "ONFIRSTWHOLEBAND", ;
		ONGROUPCHANGE.Alignment = 0, ;
		ONGROUPCHANGE.Name = "ONGROUPCHANGE", ;
		GROUP.Left = 40, ;
		GROUP.Name = "GROUP", ;
		GROUP.Width = 265, ;
		ONOVERFLOW.Alignment = 0, ;
		ONOVERFLOW.Name = "ONOVERFLOW", ;
		REMOVEBLANK.Alignment = 0, ;
		REMOVEBLANK.Name = "REMOVEBLANK", ;
		cmdGetExpr.Name = "cmdGetExpr", ;
		LBL1.Name = "LBL1", ;
		EXPRESSION.Left = 0, ;
		EXPRESSION.Name = "EXPRESSION", ;
		LBL2.Name = "LBL2", ;
		LBL3.Name = "LBL3"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageProtection.panel' AS panelobjectprotection WITH ;
		Height = 214, ;
		Left = 8, ;
		Name = "panel", ;
		Top = 9, ;
		Width = 329, ;
		SHP1.Left = 0, ;
		SHP1.Name = "SHP1", ;
		SHP1.Top = 7, ;
		chkObjectLock.Alignment = 0, ;
		chkObjectLock.Name = "chkObjectLock", ;
		chkObjectNoEdit.Alignment = 0, ;
		chkObjectNoEdit.Name = "chkObjectNoEdit", ;
		LBL1.Name = "LBL1", ;
		chkObjectHidden.Alignment = 0, ;
		chkObjectHidden.Name = "chkObjectHidden", ;
		chkObjectNoDelete.Alignment = 0, ;
		chkObjectNoDelete.Name = "chkObjectNoDelete", ;
		chkObjectNoSelect.Alignment = 0, ;
		chkObjectNoSelect.Name = "chkObjectNoSelect", ;
		Lbl2.Name = "Lbl2"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />
	
	PROCEDURE loadfromfrx
		*=====================================================================
		* LoadFromFrx()
		*
		* Read values from the FRX record(s) and configure the controls
		*=====================================================================
		local OkToContinue
		
		*---------------------------------------------------------------
		* Call each panel's LoadFromFrx()
		* Assigns .event and .frxCursor references
		* Removes protection panel
		* sets activePage:
		*---------------------------------------------------------------
		OkToContinue = dodefault() 
		if not m.OkToContinue
			return .F.
		endif
		
		*---------------------------------------------------------------
		* Event-specific actions:
		*   - Set title of dialog:
		*---------------------------------------------------------------
		
		if this.frxEvent.eventType = FRX_BLDR_EVENT_OBJECTCREATE
			THIS.Caption = DLG_TITLE_NEW_PREFIX_LOC + TARGET_PICTURE_LOC + DLG_TITLE_PROPERTIES_LOC
		else
			THIS.Caption = TARGET_PICTURE_LOC + DLG_TITLE_PROPERTIES_LOC
		endif
		
		if THIS.frxEvent.protected and ;
		   THIS.frxEvent.frxCursor.hasProtectionFlag( ORDER, FRX_PROTECT_OBJECT_NO_EDIT)
		
			THIS.Caption = THIS.Caption + DLG_TITLE_READONLY_SUFFIX_LOC
			OkToContinue = .F.
			
		endif
		return m.OkToContinue
	ENDPROC

	PROCEDURE frame.pageComment.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_OTHER_LOC
		#ENDIF
		THIS.HelpContextID = UI_CONTROL_PROPS_OTHER_HELP_ID        
	ENDPROC

	PROCEDURE frame.pageGeneral.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_GENERAL_LOC
		#ENDIF
		THIS.HelpContextID = UI_CONTROL_PROPS_GENERAL_HELP_ID      
	ENDPROC

	PROCEDURE frame.pagePrintWhen.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_PRINTWHEN_LOC
		#ENDIF
		THIS.HelpContextID = UI_CONTROL_PROPS_PRINTWHEN_HELP_ID    
	ENDPROC

	PROCEDURE frame.pageProtection.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_PROTECTION_LOC
		#ENDIF
		THIS.HelpContextID = UI_CONTROL_PROPS_PROTECTION_HELP_ID   
	ENDPROC

ENDDEFINE

DEFINE CLASS reportpropertieshandler AS frxhandlerform OF "frxbuilder.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="frame" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageLayout.Panelpagelayout1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageBands.Paneloptionalbands1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageBands.Paneldetailbands1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageGrouping.Panelgrouping1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageVariables.Panelreportvars1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageProtection.Panelreportprotection1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageRuler.Panelreportruler1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageDataEnv.Panelde1" UniqueID="" Timestamp="" />

	#INCLUDE "frxbuilder.h"
	Caption = "Report Properties"
	DoCreate = .T.
	Height = 384
	Name = "reportpropertieshandler"
	Width = 664
	grabber.Height = 11
	grabber.Name = "grabber"
	grabber.Width = 11
	frxcursor.Name = "frxcursor"
	cmdOK.Left = 388
	cmdOK.Name = "cmdOK"
	cmdOK.TabIndex = 2
	cmdOK.Top = 356
	cmdCancel.Left = 532
	cmdCancel.Name = "cmdCancel"
	cmdCancel.TabIndex = 3
	cmdCancel.Top = 352
	cmdHelp.Left = 292
	cmdHelp.Name = "cmdHelp"
	cmdHelp.Top = 356

	ADD OBJECT 'frame' AS pgfhandlerframe WITH ;
		Anchor = 0, ;
		autorefreshonpagechange = .T., ;
		ErasePage = .T., ;
		Height = 331, ;
		Left = 6, ;
		Name = "frame", ;
		PageCount = 7, ;
		TabIndex = 1, ;
		Top = 9, ;
		Width = 606, ;
		Pge1.Caption = "Page Layout", ;
		Pge1.Name = "pageLayout", ;
		Pge2.Caption = "Optional Bands", ;
		Pge2.Name = "pageBands", ;
		Pge3.Caption = "Data Grouping", ;
		Pge3.Name = "pageGrouping", ;
		Pge4.Caption = "Variables", ;
		Pge4.Name = "pageVariables", ;
		Pge5.Caption = "Protection", ;
		Pge5.Name = "pageProtection", ;
		Pge6.Caption = "Ruler/Grid", ;
		Pge6.Name = "pageRuler", ;
		Pge7.Caption = "Data Environment", ;
		Pge7.Name = "pageDataEnv"
		*< END OBJECT: ClassLib="frxcontrols.vcx" BaseClass="pageframe" />

	ADD OBJECT 'frame.pageBands.Paneldetailbands1' AS paneldetailbands WITH ;
		Height = 204, ;
		Left = 303, ;
		Name = "Paneldetailbands1", ;
		Top = 6, ;
		Width = 245, ;
		Shp3.Left = 0, ;
		Shp3.Name = "Shp3", ;
		Shp3.Top = 8, ;
		Shp3.Width = 224, ;
		detailList.Name = "detailList", ;
		cmdAdd.Left = 9, ;
		cmdAdd.Name = "cmdAdd", ;
		Lbl3.Name = "Lbl3", ;
		cmdRemove.Name = "cmdRemove"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageBands.Paneloptionalbands1' AS paneloptionalbands WITH ;
		Left = 8, ;
		Name = "Paneloptionalbands1", ;
		Top = 6, ;
		Shp2.Name = "Shp2", ;
		Shp1.Name = "Shp1", ;
		Lbl2.Name = "Lbl2", ;
		Lbl1.Name = "Lbl1", ;
		chkHasTitle.Alignment = 0, ;
		chkHasTitle.Name = "chkHasTitle", ;
		chkTitleNewPage.Alignment = 0, ;
		chkTitleNewPage.Name = "chkTitleNewPage", ;
		chkHasSummary.Alignment = 0, ;
		chkHasSummary.Name = "chkHasSummary", ;
		chkSummaryNewPage.Alignment = 0, ;
		chkSummaryNewPage.Name = "chkSummaryNewPage", ;
		chkPageHeader.Alignment = 0, ;
		chkPageHeader.Name = "chkPageHeader", ;
		chkPageFooter.Alignment = 0, ;
		chkPageFooter.Name = "chkPageFooter"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageDataEnv.Panelde1' AS panelde WITH ;
		Left = 11, ;
		Name = "Panelde1", ;
		Top = 15, ;
		opgDeSource.Name = "opgDeSource", ;
		opgDeSource.Opt1.Left = 9, ;
		opgDeSource.Opt1.Name = "Opt1", ;
		opgDeSource.Opt1.Top = 17, ;
		opgDeSource.Opt2.Left = 9, ;
		opgDeSource.Opt2.Name = "Opt2", ;
		opgDeSource.Opt2.Top = 38, ;
		CMDLOAD.Name = "CMDLOAD", ;
		Lbl2.Name = "Lbl2", ;
		txtClass.Name = "txtClass", ;
		txtClasslib.Name = "txtClasslib", ;
		LBL3.Name = "LBL3", ;
		Lbl4.Name = "Lbl4", ;
		chkPrivateSession.Alignment = 0, ;
		chkPrivateSession.Name = "chkPrivateSession", ;
		chkUseFullPath.Alignment = 0, ;
		chkUseFullPath.Name = "chkUseFullPath"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageGrouping.Panelgrouping1' AS panelgrouping WITH ;
		Anchor = 15, ;
		Left = 6, ;
		Name = "Panelgrouping1", ;
		Top = 5, ;
		groupList.Name = "groupList", ;
		Lbl1.Name = "Lbl1", ;
		edtExpr.Name = "edtExpr", ;
		Lbl2.Name = "Lbl2", ;
		chkReprint.Alignment = 0, ;
		chkReprint.Name = "chkReprint", ;
		lblThreshold.Name = "lblThreshold", ;
		cmdAdd.Name = "cmdAdd", ;
		cmdGetExpr.Name = "cmdGetExpr", ;
		cmdRemove.Name = "cmdRemove", ;
		spnThreshold.Name = "spnThreshold", ;
		opgPaginate.Name = "opgPaginate", ;
		opgPaginate.Opt1.Left = 17, ;
		opgPaginate.Opt1.Name = "Opt1", ;
		opgPaginate.Opt1.Top = 12, ;
		opgPaginate.Opt2.Left = 17, ;
		opgPaginate.Opt2.Name = "Opt2", ;
		opgPaginate.Opt2.Top = 33, ;
		opgPaginate.Opt3.Left = 17, ;
		opgPaginate.Opt3.Name = "Opt3", ;
		opgPaginate.Opt3.Top = 54, ;
		opgPaginate.Opt4.Left = 17, ;
		opgPaginate.Opt4.Name = "Opt4", ;
		opgPaginate.Opt4.Top = 75, ;
		Lbl4.Name = "Lbl4"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageLayout.Panelpagelayout1' AS panelpagelayout WITH ;
		Left = 9, ;
		Name = "Panelpagelayout1", ;
		Top = 7, ;
		Width = 564, ;
		Shp1.Name = "Shp1", ;
		Lbl1.Name = "Lbl1", ;
		Lbl5.Name = "Lbl5", ;
		spnNumberCols.Name = "spnNumberCols", ;
		lblWidth.Name = "lblWidth", ;
		spnWidth.Name = "spnWidth", ;
		lblSpacing.Name = "lblSpacing", ;
		spnSpacing.Name = "spnSpacing", ;
		LBL8.Name = "LBL8", ;
		spnLeftMargin.Name = "spnLeftMargin", ;
		opgPrintArea.Name = "opgPrintArea", ;
		opgPrintArea.opt1.Left = 10, ;
		opgPrintArea.opt1.Name = "opt1", ;
		opgPrintArea.opt1.Top = 13, ;
		opgPrintArea.opt2.Left = 10, ;
		opgPrintArea.opt2.Name = "opt2", ;
		opgPrintArea.opt2.Top = 34, ;
		LBL3.Name = "LBL3", ;
		opgPrintOrder.Name = "opgPrintOrder", ;
		opgPrintOrder.opt1.Left = 10, ;
		opgPrintOrder.opt1.Name = "opt1", ;
		opgPrintOrder.opt1.Top = 14, ;
		opgPrintOrder.opt2.Left = 10, ;
		opgPrintOrder.opt2.Name = "opt2", ;
		opgPrintOrder.opt2.Top = 35, ;
		Lbl4.Name = "Lbl4", ;
		Shape2.Name = "Shape2", ;
		Lbl6.Name = "Lbl6", ;
		txtFont.Name = "txtFont", ;
		cmdPickFont.Name = "cmdPickFont", ;
		oFormatter.Name = "oFormatter", ;
		chkOverrideCharset.Alignment = 0, ;
		chkOverrideCharset.Name = "chkOverrideCharset", ;
		Shp2.Name = "Shp2", ;
		Lbl2.Name = "Lbl2", ;
		txtPrintDevice.Name = "txtPrintDevice", ;
		Cmd1.Name = "Cmd1", ;
		chkPrintEnvironment.Alignment = 0, ;
		chkPrintEnvironment.Name = "chkPrintEnvironment", ;
		pagePreview.Name = "pagePreview", ;
		pagePreview.Page.extraMargin.Name = "extraMargin", ;
		pagePreview.Page.marginBox.Name = "marginBox", ;
		pagePreview.Page.Name = "Page", ;
		pagePreview.shadow.Name = "shadow"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageProtection.Panelreportprotection1' AS panelreportprotection WITH ;
		Left = 9, ;
		Name = "Panelreportprotection1", ;
		Top = 7, ;
		SHP1.Name = "SHP1", ;
		LBL1.Name = "LBL1", ;
		chkPageLayout.Alignment = 0, ;
		chkPageLayout.Name = "chkPageLayout", ;
		LBL4.Name = "LBL4", ;
		chkOptionalBands.Alignment = 0, ;
		chkOptionalBands.Name = "chkOptionalBands", ;
		chkDataEnv.Alignment = 0, ;
		chkDataEnv.Name = "chkDataEnv", ;
		chkDataGrouping.Alignment = 0, ;
		chkDataGrouping.Name = "chkDataGrouping", ;
		chkPreview.Alignment = 0, ;
		chkPreview.Name = "chkPreview", ;
		chkReportPrint.Alignment = 0, ;
		chkReportPrint.Name = "chkReportPrint", ;
		chkVariables.Alignment = 0, ;
		chkVariables.Name = "chkVariables"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageRuler.Panelreportruler1' AS panelreportruler WITH ;
		Left = 11, ;
		Name = "Panelreportruler1", ;
		Top = 6, ;
		Shp2.Name = "Shp2", ;
		SHP1.Name = "SHP1", ;
		LBL6.Name = "LBL6", ;
		cboRuler.Name = "cboRuler", ;
		chkShowPosition.Alignment = 0, ;
		chkShowPosition.Name = "chkShowPosition", ;
		LBL1.Name = "LBL1", ;
		chkVisibleGrid.Alignment = 0, ;
		chkVisibleGrid.Name = "chkVisibleGrid", ;
		chkSnapTo.Alignment = 0, ;
		chkSnapTo.Name = "chkSnapTo", ;
		LBL4.Name = "LBL4", ;
		spnHorizontalSpacing.Name = "spnHorizontalSpacing", ;
		LBL5.Name = "LBL5", ;
		spnVerticalSpacing.Name = "spnVerticalSpacing", ;
		Lbl2.Name = "Lbl2"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageVariables.Panelreportvars1' AS panelreportvars WITH ;
		Anchor = 15, ;
		Left = 6, ;
		Name = "Panelreportvars1", ;
		Top = 4, ;
		varList.Name = "varList", ;
		Lbl1.Name = "Lbl1", ;
		edtStoreValue.Name = "edtStoreValue", ;
		Lbl3.Name = "Lbl3", ;
		edtInitialValue.Name = "edtInitialValue", ;
		cmdAdd.Name = "cmdAdd", ;
		cmdGetExpr.Name = "cmdGetExpr", ;
		cmdRemove.Name = "cmdRemove", ;
		cmdGetExpr2.Name = "cmdGetExpr2", ;
		Lbl4.Name = "Lbl4", ;
		Lbl5.Name = "Lbl5", ;
		Lbl6.Name = "Lbl6", ;
		cboCalculate.Name = "cboCalculate", ;
		CHKRELEASE.Alignment = 0, ;
		CHKRELEASE.Name = "CHKRELEASE", ;
		cboReset.Name = "cboReset"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />
	
	PROCEDURE KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		dodefault(nKeyCode, nShiftAltCtrl)
		
		*---------------------------------------------------
		* Keypress in the parent class can change the 
		* active tab. There is code in the frame.click()
		* to update the tab as it changes, so force the code 
		* to run (because click() won't run itself):
		*---------------------------------------------------
		if THIS.frame.CurrentPage <> THIS.frame.ActivePage
			THIS.Frame.Click()
		endif
	ENDPROC

	PROCEDURE loadfromfrx
		*=====================================================================
		* LoadFromFrx()
		*
		* Read values from the FRX record(s) and configure the controls
		*                -------------------------------------
		*                INTENTIONALLY OVERRIDES PARENT METHOD 
		*                -------------------------------------
		* Note: We are OVERRIDING the default method here. 
		* The code is basically following the same pattern, but 
		* there are some different things to do for the report header:
		*=====================================================================
		local OkToContinue, i, j, oPage, oPanel
		OkToContinue = .T.
		
		*---------------------------------------------------------------
		* Ensure we are on the report header record:
		*---------------------------------------------------------------
		select frx
		locate for OBJTYPE = FRX_OBJTYP_REPORTHEADER
		
		*-------------------------------------------------------------
		* ENH for SP2: Open memberdata cursor
		*-------------------------------------------------------------
		if not THIS.frxCursor.UnpackMemberData()
			THIS.frxEvent.SetHandledByBuilder(.T.)
			return .F.
		endif
		
		*-------------------------------------------------------------
		* Enhancement for SP1: 
		* Add any additional tab classes registered as 'T' in Handler Registry:
		*-------------------------------------------------------------
		local curRec, curSel, cPageName
		curSel = select(0)
		select frxRegistry
		curRec = recno()
		
		scan for REC_TYPE = HANDLREG_EXTRATAB ;
		     and inlist( EVENTTYPE, THIS.frxEvent.EventType, -1 ) ;
		     and inlist( OBJTYPE,   THIS.frxEvent.ObjType,   -1 ) ;
		     and inlist( OBJCODE,   THIS.frxEvent.ObjCode,   -1 ) ;
		     and not deleted()
			
			cPageName = 'T' + sys(2015)
		
			if THIS.Frame.NewRegisteredObject( m.cPageName, trim(HNDL_CLASS),trim(HNDL_LIB))
				*------------------------------------------------
				* Enhancement for SP2:
				* Allow setting of PageOrder thru the FLTR_ORDR
				* column. Note that it might be C(1) or I 
				*------------------------------------------------
				if val(trans(FLTR_ORDR)) > 0	
					THIS.Frame.Pages( THIS.Frame.PageCount ).PageOrder = val(trans(FLTR_ORDR))
				endif
				THIS.HasAdditionalTabs = .T.
		
			endif
		endscan     
		go m.curRec
		select (m.curSel)
		
		*-------------------------------------------------------------
		* Assign references to utility objects:
		*-------------------------------------------------------------
		for i = 1 to THIS.Frame.PageCount
			oPage = THIS.Frame.Pages(m.i)
			for j = 1 to oPage.ControlCount
				oPanel = oPage.Controls(m.j)
		
				*----------------------------------------------
				* Fix for SP1: Does not rely on panel control
				* being subclasses from frxPanel; rather, uses 
				* reflection instead:
				*----------------------------------------------
				if pemstatus( m.oPanel, "event", 5 )
					oPanel.event     = THIS.frxEvent 
				endif
				if pemstatus( m.oPanel, "frxCursor", 5 )
					oPanel.frxCursor = THIS.frxEvent.frxCursor
				endif
				
				oPanel = .NULL.			
			endfor
			oPage = .NULL.
		endfor
		
		*----------------------------------------------------------------
		* New for SP2: Sync up the fonts if there are any new tabs
		*----------------------------------------------------------------
		if THIS.HasAdditionalTabs 
			THIS.CheckForLargeFonts()
		endif
		
		*-------------------------------------------------------------
		* Invoke every control's LoadFromFrx():
		*-------------------------------------------------------------
		* SP2: Delegate to the pageframe:
		*-------------------------------------------------------------
		OkToContinue = THIS.frame.LoadPanelsFromFrx()
		
		
		*-------------------------------------------------------------
		* Change for SP2: Remove any tabs that do not have any visible
		*                 contents (controls), rather than explicitly 
		*                 removing the page objects by name
		*                 This replaces the former method of 
		*                 hiding protected pages.
		*-------------------------------------------------------------
		THIS.frame.RemoveUnusedPages()
		
		*---------------------------------------------------------------
		* Determine the name of the page appropriate for the event:
		*---------------------------------------------------------------
		local i, iPageToActivate, cPageName
		cPageName = "pageLayout"	
		iPageToActivate = 1
		
		do case
		case THIS.frxevent.eventType = FRX_BLDR_EVENT_PROPERTIES
			cPageName = "pageLayout"
		
		case THIS.frxevent.eventType = FRX_BLDR_EVENT_VARIABLES
			cPageName = "pageVariables"
		
		case THIS.frxevent.eventType = FRX_BLDR_EVENT_OPTIONALBANDS
			cPageName = "pageBands"
		
		case THIS.frxevent.eventType = FRX_BLDR_EVENT_DATAGROUPING
			cPageName = "pageGrouping"
		
		case THIS.frxevent.eventType = FRX_BLDR_EVENT_SETGRIDSCALE
			cPageName = "pageRuler"
		
		case THIS.frxevent.eventType = FRX_BLDR_EVENT_IMPORTDE	
			cPageName = "pageDataEnv"
		
		endcase
		
		*---------------------------------------------------------------
		* Set the active page:
		*---------------------------------------------------------------
		for i = 1 to THIS.Frame.PageCount
			if upper(THIS.Frame.Pages[m.i].Name) = upper(m.cPageName)
				iPageToActivate = m.i
			endif
		endfor
		
		THIS.PageToActivate  = m.iPageToActivate
		*THIS.Frame.ActivePage = m.iPageToActivate
		THIS.Frame.CurrentPage = m.iPageToActivate
		
		return
		
	ENDPROC

	PROCEDURE savetofrx
		*=======================================================================
		* SaveToFrx()
		*
		* Write values back to the FRX. 
		*                -------------------------------------
		*                INTENTIONALLY OVERRIDES PARENT METHOD 
		*                -------------------------------------
		* In this method, we iterate through the container objects, calling 
		* their .SaveToFRX() methods.
		*=======================================================================
		
		*-------------------------------------------------------------
		* instrumenting the xbase code
		*-------------------------------------------------------------
		if DEBUG_WAITMSG_WHILE_EXECUTING
			wait window "Saving changes..." nowait
		endif
		
		*-------------------------------------------------------------
		* Call each panel's SaveToFrx() method:
		* This method returns .T. if ok to exit the dialog:
		*-------------------------------------------------------------
		if type("THIS.frame") = "O" and ;
		   upper(THIS.frame.BaseClass)="PAGEFRAME"
		
			if not THIS.frame.SavePanelsToFrx()
				wait clear
				return .F.
			endif
			
		endif
		
		*---------------------------------------------------------------
		* Ensure we are on the report header record:
		*---------------------------------------------------------------
		select frx
		locate for OBJTYPE = FRX_OBJTYP_REPORTHEADER
		
		*-------------------------------------------------------------
		* ENH for SP2: Put memberdata cursor back into the STYLE column:
		*-------------------------------------------------------------
		if THIS.frxCursor.PackupMemberData()
			if used("memberdata")
				use in memberdata
			endif
		endif
		
		*-------------------------------------------------------------
		* Set the return flags:
		*-------------------------------------------------------------
		THIS.frxEvent.setReloadChanges(.T.)
		THIS.frxEvent.setHandledByBuilder(.T.)
								  
		return .T.						 
		
	ENDPROC

	PROCEDURE frame.pageBands.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_OPTIONALBANDS_LOC
		#ENDIF
		THIS.HelpContextID = UI_REPORT_PROPS_OPTIONALBANDS_HELP_ID 
	ENDPROC

	PROCEDURE frame.pageDataEnv.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_DATAENV_LOC
		#ENDIF
		THIS.HelpContextID = UI_REPORT_PROPS_DATAENV_HELP_ID       
	ENDPROC

	PROCEDURE frame.pageGrouping.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_DATAGROUP_LOC
		#ENDIF
		THIS.HelpContextID = UI_REPORT_PROPS_DATAGROUP_HELP_ID     
	ENDPROC

	PROCEDURE frame.pageLayout.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_PAGELAYOUT_LOC
		#ENDIF
		THIS.HelpContextID = UI_REPORT_PROPS_PAGELAYOUT_HELP_ID    
	ENDPROC

	PROCEDURE frame.pageProtection.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_PROTECTION_LOC
		#ENDIF
		THIS.HelpContextID = UI_REPORT_PROPS_PROTECTION_HELP_ID    
	ENDPROC

	PROCEDURE frame.pageRuler.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_RULERGRID_LOC
		#ENDIF
		THIS.HelpContextID = UI_REPORT_PROPS_RULERGRID_HELP_ID     
	ENDPROC

	PROCEDURE frame.pageVariables.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_VARIABLES_LOC
		#ENDIF
		THIS.HelpContextID = UI_REPORT_PROPS_VARIABLES_HELP_ID
	ENDPROC

ENDDEFINE

DEFINE CLASS shapelinehandler AS frxhandlerform OF "frxbuilder.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="frame" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageGeneral.Panelshape1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageGeneral.Panelabsolutepositioning1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageStyle.Panelshapeformat1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pagePrintWhen.Panelprintwhen1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageProtection.Panelobjectprotection1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageComment.Panelcommentuser1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageComment.Paneltooltip1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="frame.pageComment.Panelmemberdata1" UniqueID="" Timestamp="" />

	#INCLUDE "frxbuilder.h"
	BorderStyle = 3
	Caption = "Shape/Line"
	DoCreate = .T.
	Height = 400
	Name = "shapelinehandler"
	Width = 405
	grabber.Height = 11
	grabber.Name = "grabber"
	grabber.Width = 11
	frxcursor.Name = "frxcursor"
	cmdOK.Left = 148
	cmdOK.Name = "cmdOK"
	cmdOK.TabIndex = 2
	cmdOK.Top = 372
	cmdCancel.Left = 232
	cmdCancel.Name = "cmdCancel"
	cmdCancel.TabIndex = 3
	cmdCancel.Top = 372
	cmdHelp.Left = 284
	cmdHelp.Name = "cmdHelp"
	cmdHelp.Top = 344

	ADD OBJECT 'frame' AS pgfhandlerframe WITH ;
		ErasePage = .T., ;
		Height = 343, ;
		Left = 6, ;
		Name = "frame", ;
		PageCount = 5, ;
		TabIndex = 1, ;
		Top = 9, ;
		Width = 370, ;
		Pge1.Caption = "General", ;
		Pge1.Name = "pageGeneral", ;
		Pge2.Caption = "Style", ;
		Pge2.Name = "pageStyle", ;
		Pge3.Caption = "Print when", ;
		Pge3.Name = "pagePrintWhen", ;
		Pge4.Caption = "Protection", ;
		Pge4.Name = "pageProtection", ;
		Pge5.Caption = "Other", ;
		Pge5.Name = "pageComment"
		*< END OBJECT: ClassLib="frxcontrols.vcx" BaseClass="pageframe" />

	ADD OBJECT 'frame.pageComment.Panelcommentuser1' AS panelcommentuser WITH ;
		Height = 164, ;
		Left = 7, ;
		Name = "Panelcommentuser1", ;
		Top = 4, ;
		Width = 354, ;
		shpUser.Height = 2, ;
		shpUser.Left = 5, ;
		shpUser.Name = "shpUser", ;
		shpUser.Top = 90, ;
		shpUser.Width = 334, ;
		LBLCOMMENTTEXT.Height = 66, ;
		LBLCOMMENTTEXT.Left = 56, ;
		LBLCOMMENTTEXT.Name = "LBLCOMMENTTEXT", ;
		LBLCOMMENTTEXT.Top = 17, ;
		LBLCOMMENTTEXT.Width = 286, ;
		CMDCOMMENT.Left = 220, ;
		CMDCOMMENT.Name = "CMDCOMMENT", ;
		CMDCOMMENT.Top = 60, ;
		LBLUSERCAPTION.Name = "LBLUSERCAPTION", ;
		LBLUSERTEXT.Height = 61, ;
		LBLUSERTEXT.Left = 58, ;
		LBLUSERTEXT.Name = "LBLUSERTEXT", ;
		LBLUSERTEXT.Top = 98, ;
		LBLUSERTEXT.Width = 284, ;
		IMGCOMMENT.Height = 32, ;
		IMGCOMMENT.Name = "IMGCOMMENT", ;
		IMGCOMMENT.Width = 32, ;
		CMDUSER.Left = 220, ;
		CMDUSER.Name = "CMDUSER", ;
		CMDUSER.Top = 134, ;
		Shape1.Height = 2, ;
		Shape1.Left = 5, ;
		Shape1.Name = "Shape1", ;
		Shape1.Top = 9, ;
		Shape1.Width = 334, ;
		LBLCOMMENTCAPTION.Name = "LBLCOMMENTCAPTION", ;
		IMGUSER.Height = 32, ;
		IMGUSER.Name = "IMGUSER", ;
		IMGUSER.Width = 32
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageComment.Panelmemberdata1' AS panelmemberdata WITH ;
		Height = 86, ;
		Left = 7, ;
		Name = "Panelmemberdata1", ;
		Top = 227, ;
		Width = 354, ;
		LBLSCRIPTTEXT.Height = 62, ;
		LBLSCRIPTTEXT.Left = 56, ;
		LBLSCRIPTTEXT.Name = "LBLSCRIPTTEXT", ;
		LBLSCRIPTTEXT.Top = 18, ;
		LBLSCRIPTTEXT.Width = 290, ;
		Shape4.Height = 2, ;
		Shape4.Left = 5, ;
		Shape4.Name = "Shape4", ;
		Shape4.Top = 9, ;
		Shape4.Width = 334, ;
		CMDSCRIPT.Left = 222, ;
		CMDSCRIPT.Name = "CMDSCRIPT", ;
		CMDSCRIPT.Top = 54, ;
		IMGSCRIPT.Height = 32, ;
		IMGSCRIPT.Name = "IMGSCRIPT", ;
		IMGSCRIPT.Width = 32, ;
		LBLSCRIPTCAPTION.Name = "LBLSCRIPTCAPTION"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageComment.Paneltooltip1' AS paneltooltip WITH ;
		Height = 78, ;
		Left = 8, ;
		Name = "Paneltooltip1", ;
		Top = 159, ;
		Width = 353, ;
		SHPUSER.Height = 2, ;
		SHPUSER.Left = 5, ;
		SHPUSER.Name = "SHPUSER", ;
		SHPUSER.Top = 9, ;
		SHPUSER.Width = 334, ;
		lblTooltipText.Height = 55, ;
		lblTooltipText.Left = 56, ;
		lblTooltipText.Name = "lblTooltipText", ;
		lblTooltipText.Top = 17, ;
		lblTooltipText.Width = 285, ;
		CmdTooltip.Left = 220, ;
		CmdTooltip.Name = "CmdTooltip", ;
		CmdTooltip.Top = 47, ;
		lblTooltipCaption.Name = "lblTooltipCaption", ;
		imgTooltip.Height = 32, ;
		imgTooltip.Name = "imgTooltip", ;
		imgTooltip.Width = 32
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageGeneral.Panelabsolutepositioning1' AS panelabsolutepositioning WITH ;
		Left = 8, ;
		Name = "Panelabsolutepositioning1", ;
		TabIndex = 2, ;
		Top = 191, ;
		Width = 341, ;
		Shp1.Left = 0, ;
		Shp1.Name = "Shp1", ;
		Shp1.Top = 8, ;
		Shp1.Width = 332, ;
		spnHeight.Left = 165, ;
		spnHeight.Name = "spnHeight", ;
		spnWidth.Left = 165, ;
		spnWidth.Name = "spnWidth", ;
		spnTop.Name = "spnTop", ;
		spnLeft.Name = "spnLeft", ;
		lblHeading.Name = "lblHeading", ;
		Lbl4.Left = 166, ;
		Lbl4.Name = "Lbl4", ;
		Lbl5.Left = 165, ;
		Lbl5.Name = "Lbl5", ;
		Lbl7.Name = "Lbl7", ;
		Lbl6.Name = "Lbl6"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageGeneral.Panelshape1' AS panelshape WITH ;
		Left = 8, ;
		Name = "Panelshape1", ;
		TabIndex = 1, ;
		Top = 3, ;
		objPosition.gifBottom.Height = 34, ;
		objPosition.gifBottom.Name = "gifBottom", ;
		objPosition.gifBottom.Width = 31, ;
		objPosition.gifFloat.Height = 34, ;
		objPosition.gifFloat.Name = "gifFloat", ;
		objPosition.gifFloat.Width = 31, ;
		objPosition.gifTop.Height = 34, ;
		objPosition.gifTop.Name = "gifTop", ;
		objPosition.gifTop.Width = 31, ;
		objPosition.Label.Name = "Label", ;
		objPosition.Name = "objPosition", ;
		objPosition.OptionGroup.Name = "OptionGroup", ;
		objPosition.OptionGroup.opt1.Left = 66, ;
		objPosition.OptionGroup.opt1.Name = "opt1", ;
		objPosition.OptionGroup.opt1.Top = 13, ;
		objPosition.OptionGroup.opt2.Left = 66, ;
		objPosition.OptionGroup.opt2.Name = "opt2", ;
		objPosition.OptionGroup.opt2.Top = 34, ;
		objPosition.OptionGroup.opt3.Left = 66, ;
		objPosition.OptionGroup.opt3.Name = "opt3", ;
		objPosition.OptionGroup.opt3.Top = 55, ;
		objStretch.gifNoStretch.Height = 34, ;
		objStretch.gifNoStretch.Name = "gifNoStretch", ;
		objStretch.gifNoStretch.Width = 31, ;
		objStretch.gifToHeight.Height = 34, ;
		objStretch.gifToHeight.Name = "gifToHeight", ;
		objStretch.gifToHeight.Width = 31, ;
		objStretch.gifToTallest.Height = 34, ;
		objStretch.gifToTallest.Name = "gifToTallest", ;
		objStretch.gifToTallest.Width = 31, ;
		objStretch.Label.Name = "Label", ;
		objStretch.Name = "objStretch", ;
		objStretch.OptionGroup.Name = "OptionGroup", ;
		objStretch.OptionGroup.opt1.Left = 66, ;
		objStretch.OptionGroup.opt1.Name = "opt1", ;
		objStretch.OptionGroup.opt1.Top = 12, ;
		objStretch.OptionGroup.opt2.Left = 66, ;
		objStretch.OptionGroup.opt2.Name = "opt2", ;
		objStretch.OptionGroup.opt2.Top = 33, ;
		objStretch.OptionGroup.opt3.Left = 66, ;
		objStretch.OptionGroup.opt3.Name = "opt3", ;
		objStretch.OptionGroup.opt3.Top = 54
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pagePrintWhen.Panelprintwhen1' AS panelprintwhen WITH ;
		Height = 266, ;
		Left = 8, ;
		Name = "Panelprintwhen1", ;
		Top = 9, ;
		Shp1.Name = "Shp1", ;
		PrintRepeated.Name = "PrintRepeated", ;
		PrintRepeated.opt1.Left = 10, ;
		PrintRepeated.opt1.Name = "opt1", ;
		PrintRepeated.opt1.Top = 10, ;
		PrintRepeated.opt2.Left = 10, ;
		PrintRepeated.opt2.Name = "opt2", ;
		PrintRepeated.opt2.Top = 30, ;
		onFirstWholeBand.Alignment = 0, ;
		onFirstWholeBand.Name = "onFirstWholeBand", ;
		onGroupChange.Alignment = 0, ;
		onGroupChange.Name = "onGroupChange", ;
		group.Name = "group", ;
		onOverflow.Alignment = 0, ;
		onOverflow.Name = "onOverflow", ;
		removeBlank.Alignment = 0, ;
		removeBlank.Name = "removeBlank", ;
		cmdGetExpr.Name = "cmdGetExpr", ;
		Lbl1.Name = "Lbl1", ;
		Expression.Name = "Expression", ;
		Lbl2.Name = "Lbl2", ;
		LBL3.Name = "LBL3"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageProtection.Panelobjectprotection1' AS panelobjectprotection WITH ;
		Left = 8, ;
		Name = "Panelobjectprotection1", ;
		Top = 6, ;
		Shp1.Name = "Shp1", ;
		chkObjectLock.Alignment = 0, ;
		chkObjectLock.Name = "chkObjectLock", ;
		chkObjectNoEdit.Alignment = 0, ;
		chkObjectNoEdit.Name = "chkObjectNoEdit", ;
		Lbl1.Name = "Lbl1", ;
		chkObjectHidden.Alignment = 0, ;
		chkObjectHidden.Name = "chkObjectHidden", ;
		chkObjectNoDelete.Alignment = 0, ;
		chkObjectNoDelete.Name = "chkObjectNoDelete", ;
		chkObjectNoSelect.Alignment = 0, ;
		chkObjectNoSelect.Name = "chkObjectNoSelect", ;
		LBL2.Name = "LBL2"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'frame.pageStyle.Panelshapeformat1' AS panelshapeformat WITH ;
		Height = 285, ;
		Left = 8, ;
		Name = "Panelshapeformat1", ;
		Top = 3, ;
		Width = 333, ;
		Shape2.Height = 67, ;
		Shape2.Left = 1, ;
		Shape2.Name = "Shape2", ;
		Shape2.Top = 95, ;
		Shape2.Width = 288, ;
		Shape1.Height = 54, ;
		Shape1.Left = 1, ;
		Shape1.Name = "Shape1", ;
		Shape1.Width = 288, ;
		opgMode.Left = 1, ;
		opgMode.Name = "opgMode", ;
		opgMode.opt1.Left = 21, ;
		opgMode.opt1.Name = "opt1", ;
		opgMode.opt1.Top = 10, ;
		opgMode.opt2.Left = 148, ;
		opgMode.opt2.Name = "opt2", ;
		opgMode.opt2.Top = 10, ;
		opgMode.Width = 288, ;
		spnCurvature.Name = "spnCurvature", ;
		chkForeDefault.Alignment = 0, ;
		chkForeDefault.Name = "chkForeDefault", ;
		lblCurvature.Name = "lblCurvature", ;
		chkBackDefault.Alignment = 0, ;
		chkBackDefault.Name = "chkBackDefault", ;
		lblMode.Name = "lblMode", ;
		Lbl1.Name = "Lbl1", ;
		cmdForeColor.Left = 257, ;
		cmdForeColor.Name = "cmdForeColor", ;
		cmdBackcolor.Left = 257, ;
		cmdBackcolor.Name = "cmdBackcolor", ;
		cboStyle.Name = "cboStyle", ;
		LBL3.Name = "LBL3", ;
		Lbl2.Name = "Lbl2", ;
		lblWeight.Name = "lblWeight", ;
		cboWeight.Name = "cboWeight", ;
		oFormatter.Name = "oFormatter", ;
		shpPreview.Height = 27, ;
		shpPreview.Left = 48, ;
		shpPreview.Name = "shpPreview", ;
		shpPreview.Top = 237, ;
		shpPreview.Width = 200, ;
		linPreview.Height = 0, ;
		linPreview.Left = 26, ;
		linPreview.Name = "linPreview", ;
		linPreview.Top = 250, ;
		linPreview.Width = 244, ;
		CNTFORECOLOR.Name = "CNTFORECOLOR", ;
		CNTBACKCOLOR.Name = "CNTBACKCOLOR"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />
	
	PROCEDURE loadfromfrx
		*=====================================================================
		* LoadFromFrx()
		*
		* Read values from the FRX record(s) and configure the controls
		*=====================================================================
		local OKToContinue
		
		*---------------------------------------------------------------
		* Call each panel's LoadFromFrx()
		* Assigns .event and .frxCursor references
		* Removes protection panel
		* sets activePage:
		*---------------------------------------------------------------
		OkToContinue = dodefault() 
		if not m.OkToContinue
			return .F.
		endif
		
		*---------------------------------------------------------------
		* Event-specific actions:
		*   - Set title of dialog:
		*---------------------------------------------------------------
		do case
		case frx.OBJTYPE = FRX_OBJTYP_LINE
			THIS.Caption = TARGET_LINE_LOC
		
		case frx.OBJTYPE = FRX_OBJTYP_RECTANGLE
			THIS.Caption = TARGET_BOX_LOC
		
		case this.frxEvent.objType = FRX_OBJTYP_LINE
			THIS.Caption = TARGET_LINE_LOC
		
		case this.frxEvent.objType = FRX_OBJTYP_RECTANGLE
			THIS.Caption = TARGET_BOX_LOC
		
		otherwise
			THIS.Caption = TARGET_BOX_LOC
		endcase
		
		THIS.Caption = THIS.Caption + DLG_TITLE_PROPERTIES_LOC
		
		if THIS.frxEvent.eventType = FRX_BLDR_EVENT_OBJECTCREATE
			THIS.Caption = DLG_TITLE_NEW_PREFIX_LOC + THIS.Caption
		endif
		
		if THIS.frxEvent.protected and ;
		   THIS.frxEvent.frxCursor.hasProtectionFlag( ORDER, FRX_PROTECT_OBJECT_NO_EDIT)
		
			THIS.Caption = THIS.Caption + DLG_TITLE_READONLY_SUFFIX_LOC
		
			*----------------------------------------------
			* CHANGE: Do not show dialog if PROTECT_NO_EDIT
			*----------------------------------------------
			OkToContinue = .F.
		endif
		
		return m.OkToContinue
	ENDPROC

	PROCEDURE frame.pageComment.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_OTHER_LOC
		#ENDIF
		THIS.HelpContextID = UI_CONTROL_PROPS_OTHER_HELP_ID        
	ENDPROC

	PROCEDURE frame.pageGeneral.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_GENERAL_LOC
		#ENDIF
		THIS.HelpContextID = UI_CONTROL_PROPS_GENERAL_HELP_ID      
	ENDPROC

	PROCEDURE frame.pagePrintWhen.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_PRINTWHEN_LOC
		#ENDIF
		THIS.HelpContextID = UI_CONTROL_PROPS_PRINTWHEN_HELP_ID    
	ENDPROC

	PROCEDURE frame.pageProtection.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_PROTECTION_LOC
		#ENDIF
		THIS.HelpContextID = UI_CONTROL_PROPS_PROTECTION_HELP_ID   
	ENDPROC

	PROCEDURE frame.pageStyle.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_STYLE_LOC
		#ENDIF
		THIS.HelpContextID = UI_CONTROL_PROPS_STYLE_HELP_ID        
	ENDPROC

ENDDEFINE

DEFINE CLASS textlabelhandler AS frxhandlerform OF "frxbuilder.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Frame" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Frame.pageGeneral.panel" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Frame.pageGeneral.Panelabsolutepositioning1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Frame.pagePrintWhen.panel" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Frame.pageProtection.panel" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Frame.pageStyle.panel" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Frame.pageOther.Panelcommentuser1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Frame.pageOther.Paneltooltip1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Frame.pageOther.Panelmemberdata1" UniqueID="" Timestamp="" />

	#INCLUDE "frxbuilder.h"
	BorderStyle = 3
	Caption = "Text / Label"
	DoCreate = .T.
	Height = 457
	Name = "textlabelhandler"
	Width = 409
	grabber.Height = 11
	grabber.Name = "grabber"
	grabber.Width = 11
	frxcursor.Name = "frxcursor"
	CMDOK.Left = 167
	CMDOK.Name = "CMDOK"
	CMDOK.TabIndex = 2
	CMDOK.Top = 400
	CMDCANCEL.Left = 248
	CMDCANCEL.Name = "CMDCANCEL"
	CMDCANCEL.TabIndex = 3
	CMDCANCEL.Top = 400
	cmdHelp.Left = 204
	cmdHelp.Name = "cmdHelp"
	cmdHelp.Top = 420

	ADD OBJECT 'Frame' AS pgfhandlerframe WITH ;
		autorefreshonpagechange = .T., ;
		ErasePage = .T., ;
		Height = 367, ;
		Left = 4, ;
		Name = "Frame", ;
		PageCount = 5, ;
		TabIndex = 1, ;
		Top = 9, ;
		Width = 364, ;
		Pge1.Caption = "General", ;
		Pge1.Name = "pageGeneral", ;
		Pge1.PageOrder = 1, ;
		Pge2.Caption = "Print when", ;
		Pge2.Name = "pagePrintWhen", ;
		Pge2.PageOrder = 3, ;
		Pge3.Caption = "Protection", ;
		Pge3.Name = "pageProtection", ;
		Pge3.PageOrder = 4, ;
		Pge4.Caption = "Style", ;
		Pge4.Name = "pageStyle", ;
		Pge4.PageOrder = 2, ;
		Pge5.Caption = "Other", ;
		Pge5.Name = "pageOther", ;
		Pge5.PageOrder = 5
		*< END OBJECT: ClassLib="frxcontrols.vcx" BaseClass="pageframe" />

	ADD OBJECT 'Frame.pageGeneral.panel' AS paneltextlabel WITH ;
		Left = 7, ;
		Name = "panel", ;
		TabIndex = 1, ;
		Top = 8, ;
		Width = 304, ;
		OBJPOSITION.GIFBOTTOM.Height = 34, ;
		OBJPOSITION.GIFBOTTOM.Name = "GIFBOTTOM", ;
		OBJPOSITION.GIFBOTTOM.Width = 31, ;
		OBJPOSITION.GIFFLOAT.Height = 34, ;
		OBJPOSITION.GIFFLOAT.Name = "GIFFLOAT", ;
		OBJPOSITION.GIFFLOAT.Width = 31, ;
		OBJPOSITION.GIFTOP.Height = 34, ;
		OBJPOSITION.GIFTOP.Name = "GIFTOP", ;
		OBJPOSITION.GIFTOP.Width = 31, ;
		OBJPOSITION.Label.Name = "Label", ;
		OBJPOSITION.Name = "OBJPOSITION", ;
		OBJPOSITION.OptionGroup.Name = "OptionGroup", ;
		OBJPOSITION.OptionGroup.Opt1.Left = 64, ;
		OBJPOSITION.OptionGroup.Opt1.Name = "Opt1", ;
		OBJPOSITION.OptionGroup.Opt1.Top = 13, ;
		OBJPOSITION.OptionGroup.Opt2.Left = 64, ;
		OBJPOSITION.OptionGroup.Opt2.Name = "Opt2", ;
		OBJPOSITION.OptionGroup.Opt2.Top = 34, ;
		OBJPOSITION.OptionGroup.OPT3.Left = 64, ;
		OBJPOSITION.OptionGroup.OPT3.Name = "OPT3", ;
		OBJPOSITION.OptionGroup.OPT3.Top = 55, ;
		TXTCAPTION.Name = "TXTCAPTION", ;
		CMD1.Name = "CMD1", ;
		LBL3.Name = "LBL3"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'Frame.pageGeneral.Panelabsolutepositioning1' AS panelabsolutepositioning WITH ;
		Left = 7, ;
		Name = "Panelabsolutepositioning1", ;
		TabIndex = 2, ;
		Top = 149, ;
		Width = 296, ;
		Shp1.Left = 0, ;
		Shp1.Name = "Shp1", ;
		Shp1.Top = 8, ;
		Shp1.Width = 288, ;
		SPNHEIGHT.Left = 153, ;
		SPNHEIGHT.Name = "SPNHEIGHT", ;
		SPNWIDTH.Left = 153, ;
		SPNWIDTH.Name = "SPNWIDTH", ;
		SPNTOP.Name = "SPNTOP", ;
		SPNLEFT.Name = "SPNLEFT", ;
		lblHeading.Name = "lblHeading", ;
		Lbl4.Left = 154, ;
		Lbl4.Name = "Lbl4", ;
		LBL5.Left = 153, ;
		LBL5.Name = "LBL5", ;
		LBL7.Name = "LBL7", ;
		LBL6.Name = "LBL6"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'Frame.pageOther.Panelcommentuser1' AS panelcommentuser WITH ;
		Height = 165, ;
		Left = 6, ;
		Name = "Panelcommentuser1", ;
		Top = 6, ;
		Width = 345, ;
		shpUser.Height = 2, ;
		shpUser.Left = 5, ;
		shpUser.Name = "shpUser", ;
		shpUser.Top = 86, ;
		shpUser.Width = 330, ;
		LBLCOMMENTTEXT.Height = 62, ;
		LBLCOMMENTTEXT.Left = 56, ;
		LBLCOMMENTTEXT.Name = "LBLCOMMENTTEXT", ;
		LBLCOMMENTTEXT.Top = 17, ;
		LBLCOMMENTTEXT.Width = 289, ;
		CMDCOMMENT.Left = 216, ;
		CMDCOMMENT.Name = "CMDCOMMENT", ;
		CMDCOMMENT.Top = 56, ;
		LBLUSERCAPTION.Left = 2, ;
		LBLUSERCAPTION.Name = "LBLUSERCAPTION", ;
		LBLUSERCAPTION.Top = 78, ;
		LBLUSERTEXT.Height = 60, ;
		LBLUSERTEXT.Left = 58, ;
		LBLUSERTEXT.Name = "LBLUSERTEXT", ;
		LBLUSERTEXT.Top = 98, ;
		LBLUSERTEXT.Width = 287, ;
		IMGCOMMENT.Height = 32, ;
		IMGCOMMENT.Name = "IMGCOMMENT", ;
		IMGCOMMENT.Width = 32, ;
		CMDUSER.Left = 216, ;
		CMDUSER.Name = "CMDUSER", ;
		CMDUSER.Top = 134, ;
		Shape1.Height = 2, ;
		Shape1.Left = 5, ;
		Shape1.Name = "Shape1", ;
		Shape1.Top = 9, ;
		Shape1.Width = 330, ;
		LBLCOMMENTCAPTION.Name = "LBLCOMMENTCAPTION", ;
		IMGUSER.Height = 32, ;
		IMGUSER.Left = 8, ;
		IMGUSER.Name = "IMGUSER", ;
		IMGUSER.Top = 98, ;
		IMGUSER.Width = 32
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'Frame.pageOther.Panelmemberdata1' AS panelmemberdata WITH ;
		Height = 95, ;
		Left = 6, ;
		Name = "Panelmemberdata1", ;
		Top = 240, ;
		Width = 345, ;
		LBLSCRIPTTEXT.Height = 53, ;
		LBLSCRIPTTEXT.Left = 56, ;
		LBLSCRIPTTEXT.Name = "LBLSCRIPTTEXT", ;
		LBLSCRIPTTEXT.Top = 18, ;
		LBLSCRIPTTEXT.Width = 281, ;
		Shape4.Height = 2, ;
		Shape4.Left = 5, ;
		Shape4.Name = "Shape4", ;
		Shape4.Top = 9, ;
		Shape4.Width = 330, ;
		CMDSCRIPT.Left = 218, ;
		CMDSCRIPT.Name = "CMDSCRIPT", ;
		CMDSCRIPT.Top = 64, ;
		IMGSCRIPT.Height = 32, ;
		IMGSCRIPT.Name = "IMGSCRIPT", ;
		IMGSCRIPT.Width = 32, ;
		LBLSCRIPTCAPTION.Name = "LBLSCRIPTCAPTION"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'Frame.pageOther.Paneltooltip1' AS paneltooltip WITH ;
		Height = 78, ;
		Left = 6, ;
		Name = "Paneltooltip1", ;
		Top = 165, ;
		Width = 345, ;
		SHPUSER.Height = 2, ;
		SHPUSER.Left = 5, ;
		SHPUSER.Name = "SHPUSER", ;
		SHPUSER.Top = 9, ;
		SHPUSER.Width = 330, ;
		lblTooltipText.Height = 45, ;
		lblTooltipText.Left = 56, ;
		lblTooltipText.Name = "lblTooltipText", ;
		lblTooltipText.Top = 17, ;
		lblTooltipText.Width = 281, ;
		CmdTooltip.Left = 217, ;
		CmdTooltip.Name = "CmdTooltip", ;
		CmdTooltip.Top = 50, ;
		lblTooltipCaption.Name = "lblTooltipCaption", ;
		imgTooltip.Height = 32, ;
		imgTooltip.Name = "imgTooltip", ;
		imgTooltip.Width = 32
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'Frame.pagePrintWhen.panel' AS panelprintwhen WITH ;
		Left = 7, ;
		Name = "panel", ;
		Top = 7, ;
		Shp1.Name = "Shp1", ;
		PrintRepeated.Name = "PrintRepeated", ;
		PrintRepeated.opt1.Left = 10, ;
		PrintRepeated.opt1.Name = "opt1", ;
		PrintRepeated.opt1.Top = 12, ;
		PrintRepeated.opt2.Left = 10, ;
		PrintRepeated.opt2.Name = "opt2", ;
		PrintRepeated.opt2.Top = 33, ;
		onFirstWholeBand.Alignment = 0, ;
		onFirstWholeBand.Name = "onFirstWholeBand", ;
		onGroupChange.Alignment = 0, ;
		onGroupChange.Name = "onGroupChange", ;
		group.Name = "group", ;
		onOverflow.Alignment = 0, ;
		onOverflow.Name = "onOverflow", ;
		removeBlank.Alignment = 0, ;
		removeBlank.Name = "removeBlank", ;
		cmdGetExpr.Name = "cmdGetExpr", ;
		Lbl1.Name = "Lbl1", ;
		Expression.Name = "Expression", ;
		Lbl2.Name = "Lbl2", ;
		Lbl3.Name = "Lbl3"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'Frame.pageProtection.panel' AS panelobjectprotection WITH ;
		Left = 7, ;
		Name = "panel", ;
		Top = 8, ;
		Shp1.Name = "Shp1", ;
		chkObjectLock.Alignment = 0, ;
		chkObjectLock.Name = "chkObjectLock", ;
		chkObjectNoEdit.Alignment = 0, ;
		chkObjectNoEdit.Name = "chkObjectNoEdit", ;
		Lbl1.Name = "Lbl1", ;
		chkObjectHidden.Alignment = 0, ;
		chkObjectHidden.Name = "chkObjectHidden", ;
		chkObjectNoDelete.Alignment = 0, ;
		chkObjectNoDelete.Name = "chkObjectNoDelete", ;
		chkObjectNoSelect.Alignment = 0, ;
		chkObjectNoSelect.Name = "chkObjectNoSelect", ;
		LBL2.Name = "LBL2"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />

	ADD OBJECT 'Frame.pageStyle.panel' AS paneltextformat WITH ;
		Left = 6, ;
		Name = "panel", ;
		Top = 6, ;
		Width = 305, ;
		opgMode.Name = "opgMode", ;
		opgMode.Opt1.Left = 15, ;
		opgMode.Opt1.Name = "Opt1", ;
		opgMode.Opt1.Top = 12, ;
		opgMode.Opt2.Left = 15, ;
		opgMode.Opt2.Name = "Opt2", ;
		opgMode.Opt2.Top = 33, ;
		shpFontBorder.Name = "shpFontBorder", ;
		shpColorBorder.Name = "shpColorBorder", ;
		shpAlphaBorder.Name = "shpAlphaBorder", ;
		lblFont.Name = "lblFont", ;
		txtFont.Name = "txtFont", ;
		cmdFont.Name = "cmdFont", ;
		chkOverrideCharset.Alignment = 0, ;
		chkOverrideCharset.Name = "chkOverrideCharset", ;
		lblColor.Name = "lblColor", ;
		CHKFOREDEFAULT.Alignment = 0, ;
		CHKFOREDEFAULT.Name = "CHKFOREDEFAULT", ;
		cmdForeColor.Name = "cmdForeColor", ;
		CHKBACKDEFAULT.Alignment = 0, ;
		CHKBACKDEFAULT.Name = "CHKBACKDEFAULT", ;
		cmdBackcolor.Name = "cmdBackcolor", ;
		oFormatter.Name = "oFormatter", ;
		lblBackstyle.Name = "lblBackstyle", ;
		chkStrikethru.Alignment = 0, ;
		chkStrikethru.Name = "chkStrikethru", ;
		chkUnderline.Alignment = 0, ;
		chkUnderline.Name = "chkUnderline", ;
		cntPreview.canvas.hozLine.Name = "hozLine", ;
		cntPreview.canvas.Name = "canvas", ;
		cntPreview.canvas.Text.Name = "Text", ;
		cntPreview.canvas.vertLine.Name = "vertLine", ;
		cntPreview.lblSample.Name = "lblSample", ;
		cntPreview.Name = "cntPreview", ;
		cntPreview.shpBorder.Name = "shpBorder", ;
		lblAlpha.Name = "lblAlpha", ;
		spnAlphaPen.Name = "spnAlphaPen", ;
		cntBackColor.Name = "cntBackColor", ;
		cntForeColor.Name = "cntForeColor", ;
		spnAlphaFill.Name = "spnAlphaFill", ;
		lblPen.Name = "lblPen", ;
		lblFill.Name = "lblFill"
		*< END OBJECT: ClassLib="frxpanels.vcx" BaseClass="container" />
	
	PROCEDURE loadfromfrx
		*=====================================================================
		* LoadFromFrx()
		*
		* Read values from the FRX record(s) and configure the controls
		*=====================================================================
		local OkToContinue
		
		*---------------------------------------------------------------
		* Call each panel's LoadFromFrx()
		* Assigns .event and .frxCursor references
		* Removes protection panel
		* sets activePage:
		*---------------------------------------------------------------
		OkToContinue = dodefault() 
		if not m.OkToContinue
			return .F.
		endif
		
		*---------------------------------------------------------------
		* Event-specific actions:
		*   - Set title of dialog:
		*---------------------------------------------------------------
		do case
		case this.frxEvent.eventType = FRX_BLDR_EVENT_OBJECTCREATE
			THIS.Caption = DLG_TITLE_NEW_PREFIX_LOC + TARGET_TEXT_LABEL_LOC + DLG_TITLE_PROPERTIES_LOC
		
		otherwise	
		*	THIS.Caption = TARGET_TEXT_LABEL_LOC + "  " + left(trim(chrtran(EXPR,chr(13)+chr(10),"  ")),20)
			THIS.Caption = TARGET_TEXT_LABEL_LOC  + DLG_TITLE_PROPERTIES_LOC
		
		endcase
		if THIS.frxEvent.protected and ;
		   THIS.frxEvent.frxCursor.hasProtectionFlag( ORDER, FRX_PROTECT_OBJECT_NO_EDIT)
		   
			THIS.Caption = THIS.Caption + DLG_TITLE_READONLY_SUFFIX_LOC
			
			*----------------------------------------------
			* CHANGE: Do not show dialog if PROTECT_NO_EDIT
			*----------------------------------------------
			OkToContinue = .F.
		endif
		
		*---------------------------------------------------------------
		* Set the active page:
		*---------------------------------------------------------------
		THIS.pagetoactivate = 1
		
		return m.OkToContinue
		
	ENDPROC

	PROCEDURE Frame.pageGeneral.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_GENERAL_LOC
		#ENDIF
		THIS.HelpContextID = UI_CONTROL_PROPS_GENERAL_HELP_ID      
	ENDPROC

	PROCEDURE Frame.pageOther.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_OTHER_LOC
		#ENDIF
		THIS.HelpContextID = UI_CONTROL_PROPS_OTHER_HELP_ID        
	ENDPROC

	PROCEDURE Frame.pagePrintWhen.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_PRINTWHEN_LOC
		#ENDIF
		THIS.HelpContextID = UI_CONTROL_PROPS_PRINTWHEN_HELP_ID    
	ENDPROC

	PROCEDURE Frame.pageProtection.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_PROTECTION_LOC
		#ENDIF
		THIS.HelpContextID = UI_CONTROL_PROPS_PROTECTION_HELP_ID   
	ENDPROC

	PROCEDURE Frame.pageStyle.Init
		#IF USE_LOC_STRINGS_IN_UI
		    THIS.Caption = UI_TAB_STYLE_LOC
		#ENDIF
		THIS.HelpContextID = UI_CONTROL_PROPS_STYLE_HELP_ID        
	ENDPROC

ENDDEFINE
